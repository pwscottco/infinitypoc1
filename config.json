{"icon":"other","settings":{"router":{"mode":"single","animation":"off"},"theme":"default","push-notifications":{"android":{"enabled":false},"ios":{"enabled":false},"wp":{"enabled":false}},"auth":false,"loading-message":true},"name":"ETF","version":"0.0.1","pages":[{"start":true,"name":"Splash","config":[{"name":"On-Loaded Event","type":"event","item-type":"onloaded","_auto_id_":"dacc5820-4502-4d78-bef5-779f1a357c4b","actions":[{"event":"onloaded","type":"inline-function","data":{"sync":true,"code":"window.plugins.zumo.logout(function() { console.log('Logout success') }, function(r) { console.log('Logout fail') });"},"_auto_id_":"e7cb5e97-27db-416c-9d54-ceab62dfdd13"}]}],"content":[{"name":"staticSplash","type":"area","item-type":"static","content":[{"name":"imgLogo","type":"media","item-type":"image","actions":[],"expressions":{},"fileName":"Glasgow-City-Council-logo-small-3.png","_auto_id_":"c1b917d4-9439-4995-b968-f12ff3b31b29","scaleImage":true,"maxWidth":200,"maxHeight":200},{"name":"htmlContainer","type":"content","item-type":"html","content":"<h2>ETF</h2>","expressions":{},"_auto_id_":"cd756f61-c8c0-4897-9620-666a963350f7"},{"name":"btnStart","type":"control","item-type":"button","content":"Start","theme":"default","actions":[{"event":"click","type":"inline-function","data":{"code":"cti.store.messageQueue = [];\nwindow.commsManager = new CommsManager();\ncti.store.fromStart = true;\n\ncti.store.completedJobs = [];\ndelete cti.store.currentJob;\n\nif (cti.store.lastSync === undefined) {\n\tcti.store.lastSyncDisplay = \"(not yet synced)\";\n}\n\ncti.startSpinner();\nthis.$success();","sync":true},"_auto_id_":"7fdc11d6-e30a-4fae-bd58-f862c3d1814b","actions":[]},{"event":"click","type":"call-azure-app-service","data":{"name":"azureEtfService","operation":"getNeighbourhoodDropdown"},"_auto_id_":"003d836e-6e3f-488e-a52c-7397815226a0","actions":[{"event":"fail","type":"inline-function","data":{"code":"cti.stopSpinner();\n//var loader = document.getElementsByTagName('activity-loader')[0];\n//loader.hide();"},"_auto_id_":"bcd867d9-a461-4baf-8324-93022136f016"},{"event":"success","type":"inline-function","data":{"code":"cti.store.lastLogin = new Date();"},"_auto_id_":"a9bd6131-9eb8-4366-8862-9fff5c78ee03"},{"event":"success","type":"go-to-page","data":"PatchSelect","_auto_id_":"b166cc85-8de4-460e-86c0-d9ee10ed23df"}]}],"expressions":{},"_auto_id_":"870ede89-6012-4066-92cc-6ef716376875"}],"expressions":{},"_auto_id_":"04fce471-63d4-4121-8564-3a0daed42369"},{"name":"staticDescription","type":"area","item-type":"static","content":[{"name":"htmlDescription","type":"content","item-type":"html","content":"<p>Helping manage your daily Environmental Task Force jobs with image capture and feedback.</p>\n\n<p class=\"version\">{{'$store.schema.metadata.version' | store}}</p>","expressions":{},"_auto_id_":"1944b139-5707-4936-bcf9-cb1a209f7779"},{"name":"loadpanel","type":"component","item-type":"web-component-es2015","template":"<ctps-loadpanel></ctps-loadpanel>","content":[],"component":"ctps_loadpanel","_auto_id_":"fc0049d0-f504-4754-b8c1-9a203a3ce145","attributes":{},"expressions":{}}],"expressions":{},"_auto_id_":"8ea656a6-b386-4bed-83ea-fcb61a2a78fb"}]},{"name":"JobList","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"setTimeout(function() {\n  if(cti.store.azureAppServices.azureEtfService.getJobs.length == 0 && cti.store.currentJob === undefined) {\n    var popup = document.getElementById('popAllComplete');\n    popup.togglePopup();\n  }\n}, 200);"},"_auto_id_":"0f1f9607-74c8-4443-97a2-1228ba737b4a","actions":[]}],"_auto_id_":"55b8a1ed-edfa-47c2-b7e4-000c23af763e"}],"content":[{"name":"titleJobsList","type":"navigation","item-type":"title-bar","content":[{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"3159d1ac-380c-4893-a04a-3e44b0763ba0","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}},{"name":"btnMenu","type":"control","item-type":"button","content":"","theme":"default","right-icon":"fa-bars","expressions":{},"actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"openContextMenu"},"_auto_id_":"59aec78d-3ee1-4eed-855f-2c865a7483fd"}],"_auto_id_":"fa7db515-3755-406f-8b8a-144335580311"}],"extends":{"type":"area","item-type":"row"},"expressions":{},"_auto_id_":"eb397bf2-da00-4bec-a472-f882f3239305"},{"name":"staticJobsOverview","type":"area","item-type":"static","content":[{"name":"htmlOverview","type":"content","item-type":"html","content":"<h2>Current Batch for {{'$store.currentPatch' | store}}</h2>\n\n<div class=\"box\" md-actions='[{\"name\":\"go_to_page_1\",\"event\":\"click\",\"type\":\"go-to-page\",\"data\":\"CompletedJobs\"}]'>\n  <h3><span>{{'$store.completedJobs.length' | store}}</span><br>Completed (this session)</h3>\n</div>\n\n<div class=\"box\">\n  <h3><span>{{'$store.currentJob !== undefined ? $store.azureAppServices.azureEtfService.getJobs.length + 1 : $store.azureAppServices.azureEtfService.getJobs.length' | store}}</span><br>Remaining</h3>\n</div>\n\n<!--<div class=\"box btn\" md-actions='[{\"name\":\"go_to_page_1\",\"event\":\"click\",\"type\":\"go-to-page\",\"data\":\"RequestJobs\"}]'>\n  <h3>Request Additional Jobs</h3>\n</div>-->","expressions":{},"_auto_id_":"235111a5-4de7-4183-a874-58083a96d163"}],"expressions":{},"_auto_id_":"379ebb61-17bb-40e2-8e57-49ed37e23e22"},{"name":"scrollableLaterToday","type":"area","item-type":"scrollable","content":[{"name":"htmlCurrentJob","type":"content","item-type":"html","content":"<h2>Current Job</h2> \n\n<div class=\"jobRow borderTop\"> \n  <div class=\"jobCell address\">\n    <p class=\"name\">{{'$store.currentJob.CustomerName' | store}}</p>\n    <p>{{'$store.currentJob.SingleLineAddress' | store}}</p>\n    <p class=\"contact\">{{'$store.currentJob.Phone' | store}}<p>\n  </div>\n  \n  <div class=\"jobCell btn\" md-actions='[{\"name\":\"go_to_page_1\",\"event\":\"click\",\"type\":\"go-to-page\",\"data\":\"JobDetail\"}]'>\n    <p></p>\n  </div>\n</div>","expressions":{"show":"$store.currentJob !== undefined"},"_auto_id_":"8621fe09-3ae3-4e25-aec7-305b43065628"},{"name":"htmlLaterToday","type":"content","item-type":"html","content":"<h2>Your Jobs</h2>","expressions":{"show":"$store.azureAppServices.azureEtfService.getJobs.length > 0"},"_auto_id_":"5427fa84-cd29-4920-b1c1-187a506e7d31"},{"name":"lstJobs","type":"content","item-type":"list","title":"List","edit":false,"search":false,"row":"<div class=\"jobRow\"> \n  <div class=\"jobCell address\">\n    <p class=\"sla\" data-sla=\"{{$data.$item.SLA}}\" data-sla-threshhold=\"{{$data.$item.SLAThreshhold}}\">SLA: {{$data.$item.SLADisplay}} <span class=\"sla-message\"></span></p>\n    <p class=\"name\">{{$data.$item.JobRef}}; {{$data.$item.JobCategory}}</p>\n    <p>{{$data.$item.CustomerName}}</p>\n    <p>{{$data.$item.SingleLineAddress}}</p>\n    <p class=\"contact\">{{$data.$item.Phone}}<p>\n  </div>\n  \n  <div class=\"jobCell btn\">\n    <p></p>\n  </div>\n</div>","classes":"","expressions":{},"actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"setCurrentJob","params":{"rowPos":"{{$data.$item.$index}}"}},"_auto_id_":"8cfaead3-2170-438a-94f4-74b560c175f6"}],"content":[{"name":"Mrs J. Jones","address":"32 Elm Grove, Glasgow, G32 5DR","phone":"07854 254 123"}],"model":"$store.azureAppServices.azureEtfService.getJobs","autoscroll":false,"_auto_id_":"24d32b35-4f8c-4a78-9ec0-b02b60bb5e54"}],"expressions":{},"_auto_id_":"23f5ca9b-a1fb-419f-83be-c69fbf05a4c2"},{"name":"staticContextMenu","type":"area","item-type":"static","content":[{"name":"ctps_loadpanel_1","type":"component","item-type":"web-component-es2015","template":"<ctps-loadpanel></ctps-loadpanel>","content":[],"component":"ctps_loadpanel","_auto_id_":"e14c1177-0e05-43c8-9508-4791609ece11","attributes":{},"expressions":{},"actions":[]},{"name":"jobListMenu","type":"component","item-type":"web-component-es2015","template":"<ct-context-menu></ct-context-menu>","content":[{"name":"btnChangePatch","type":"control","item-type":"button","_auto_id_":"e3e75de5-1e7e-4f41-bbef-c9e586181ea9","content":"Change Neighbourhood","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Check if there is a current job and prevent change neighbourhood from occuring\nvar currentJob = cti.store.currentJob;\n\nif(currentJob) {\n  var popup = document.getElementById('logoutErr');\n  popup.togglePopup();\n}\nelse { \n  delete cti.store.fromStart;\n  \n  // Check to see if for all completed jobs we have received a confirmation response from the server\n  var allResReceived = true;\n  \n  if(cti.store.completedJobs !== undefined) {\n    for(var i = 0; i < cti.store.completedJobs.length; i++) {\n      if(cti.store.completedJobs[i].responseReceived !== true) {\n        allResReceived = false;\n        break;\n      }\n    }\n  }\n  \n  // All responses received\n  if(allResReceived) {\n    // Generate list of ids for remaining jobs\n    var ids = [];\n\n    for(var i = 0; i < cti.store.azureAppServices.azureEtfService.getJobs.length; i++) {\n      ids.push(cti.store.azureAppServices.azureEtfService.getJobs[i].JobRef)\n    }\n\n    if(ids.length > 0) {\n      // Unlock jobs message\n      var unlockJobs = {\n        endpoint: 'unlockJobs',\n        payload: {\n          jobRefs: ids\n        }\n      }\n\n      window.commsManager.addToQueue(unlockJobs);\n    }\n\n    // Action to complete after messages sent\n    var goToNext = {\n      event: 'success',\n      type: 'go-to-page',\n      data: 'PatchSelect'\n    };\n\n    // Get updated neighbourhood list message\n    var getNeighbourhood = {\n      endpoint: 'getNeighbourhoodDropdown',\n      payload: {\n          temp: 'temp'\n      },\n      logout: false,\n      actions: [goToNext]\n    }\n\n    // Add to comms queue\n    delete cti.store.azureAppServices.azureEtfService.getNeighbourhoodDropdown;\n    window.commsManager.addToQueue(getNeighbourhood);\n    window.commsManager.processQueue();\n\n    // Start spinner\n    cti.utils.callAction('call-function', { \"name\": \"startSpinner\" });\n  }\n  else {\n    // Start reconcile process\n    document.getElementById('popJobsRemaining').togglePopup();\n  }\n}"},"_auto_id_":"1592ab7d-911a-4b9b-840b-4194a3e8c3e2","actions":[]}],"left-icon":"fa-map"},{"name":"btnLogout","type":"control","item-type":"button","_auto_id_":"ccf5230e-8d18-45f4-bc11-647222d345e2","content":"Log out","theme":"default","expressions":{},"left-icon":"fa-sign-out","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var popup = document.getElementById('popLogoutConfirm');\npopup.togglePopup(); \n"},"_auto_id_":"40d5d74b-b6e7-4e39-a1f1-a0f1aa790410"}]},{"name":"btnVersion","type":"control","item-type":"button","_auto_id_":"21a17034-9dc6-459c-a730-0950e1de18c8","content":"Version {{'$store.schema.metadata.version' | store}}","theme":"default","left-icon":"fa-code-fork","expressions":{},"actions":[]}],"component":"CTContextMenu","_auto_id_":"51e225f0-e39b-4442-b15d-1796245ee20c","attributes":{},"expressions":{},"actions":[]},{"name":"popSelectJob","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlSelectJob","type":"content","item-type":"html","_auto_id_":"146a9692-0259-4003-9f99-cf956f7736f1","content":"<p>Do you wish to start this job?</p>","expressions":{}},{"name":"btnYes","type":"control","item-type":"button","_auto_id_":"adbbae3f-b465-4010-93e5-8e9e68d858ac","content":"Yes","theme":"default","expressions":{},"classes":"green","left-icon":"fa-check","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var jobList = cti.store.azureAppServices.azureEtfService.getJobs;\nvar rowPos = cti.store.selectedRow;\nvar selectedJob = jobList[rowPos];\n\nselectedJob.current = true;\ncti.store.currentJob = selectedJob;\n\njobList.splice(rowPos, 1);\ncti.store.azureAppServices.azureEtfService.getJobs = jobList;\n\nvar remainingJobCount = jobList.length + 1;\ncti.store.remainingJobCount = remainingJobCount;\n\nvar popup = document.getElementById('popSelectJob');\npopup.togglePopup();\n\nif (cti.store.pages.JobDetail !== undefined && cti.store.pages.JobDetail.txtCompletionNotes !== undefined) {\n\tdelete cti.store.pages.JobDetail.txtCompletionNotes;\n}\n\nif(cti.store.Signature !== undefined) {\n  if(cti.store.Signature.sigJobSig !== undefined) {\n    delete cti.store.Signature.sigJobSig\n  }\n}\n\nif(cti.store.FailJob !== undefined) {\n  delete cti.store.FailJob.drpFail;\n  delete cti.store.FailJob.txtFailMore;\n}\n\ncti.utils.callAction('go-to-page', 'JobDetail');"},"_auto_id_":"5244fcca-bfee-4acd-afe1-b54986d2f63a","actions":[]}]},{"name":"btnNo","type":"control","item-type":"button","_auto_id_":"052df944-27eb-4c74-8b50-23fe6afc8f06","content":"No","theme":"default","left-icon":"fa-times","expressions":{},"classes":"red","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popSelectJob"}},"_auto_id_":"83b40504-d048-4a98-9c4a-8dc48366dcf4"}]}],"component":"CTPopupBox","_auto_id_":"3784c36d-4f18-4088-8aba-93bc27f4761c","attributes":{"id":"popSelectJob"},"expressions":{},"actions":[]},{"name":"popMultiJobErr","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlMultiJobErr","type":"content","item-type":"html","_auto_id_":"564bdde6-d8ec-4336-93a7-a88d4996756b","content":"<p>You already have a current job set. Please complete the current job first.</p>","expressions":{}},{"name":"btnOkay","type":"control","item-type":"button","_auto_id_":"44295fd8-dfff-495b-96c5-a32ff2a2a314","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popMultiJobErr"}},"_auto_id_":"9042910a-6bca-4986-857e-dcc86668adf4"}]}],"component":"CTPopupBox","_auto_id_":"0f531e46-8fc5-4e88-843f-44f82af3f740","attributes":{"id":"popMultiJobErr"},"expressions":{},"actions":[]},{"name":"popLogoutErr","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlLogoutErr","type":"content","item-type":"html","_auto_id_":"4f55e8f4-71a5-4365-b9db-d6102b635092","content":"<p>You cannot log out or change neighbourhood whilst a job is active. Please complete the current job first.</p>","expressions":{}},{"name":"btnLogoutOkay","type":"control","item-type":"button","_auto_id_":"78997ecb-980c-4826-a098-1a79d50e44ba","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popLogoutErr"}},"_auto_id_":"21e620cc-0c62-40ab-911a-0959e6628b11"}]}],"component":"CTPopupBox","_auto_id_":"42228497-79c5-4acd-8fcb-77e611eafba7","attributes":{"id":"popLogoutErr"},"expressions":{}},{"name":"popLogoutConfirm","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"item_746abfa1","type":"content","item-type":"html","_auto_id_":"b7f0d85e-766d-458b-82af-a6a42d72c215","content":"<p>Would you like to logout?</p>","expressions":{}},{"name":"item_9d1264b7","type":"control","item-type":"button","_auto_id_":"7baab4b1-56b7-483f-8a78-5bc16dbb35f0","content":"Yes","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var popupConfirm = document.getElementById('popLogoutConfirm');\npopupConfirm.togglePopup(); \n\nvar currentJob = cti.store.currentJob;\n\nif(currentJob) {\n  var popup = document.getElementById('logoutErr');\n  popup.togglePopup();\n}\nelse {\n  if(window.localStorage.logoutInitiated !== 'true') {\n    // Check to see if for all completed jobs we have received a confirmation response from the server\n    var allResReceived = true;\n\n    if(cti.store.completedJobs !== undefined) {\n      for(var i = 0; i < cti.store.completedJobs.length; i++) {\n        if(cti.store.completedJobs[i].responseReceived !== true) {\n          allResReceived = false;\n        }\n      }\n    }\n\n    // All responses received\n    if(allResReceived) {\n      window.localStorage.logoutInitiated = 'true';\n      \n      // Unlock any remaining jobs\n      var ids = [];\n\n      for(var i = 0; i < cti.store.azureAppServices.azureEtfService.getJobs.length; i++) {\n        ids.push(cti.store.azureAppServices.azureEtfService.getJobs[i].JobRef)\n      }\n\n      if(ids.length > 0) {\n        var goToNext = {\n          event: 'success',\n          type: 'go-to-page',\n          data: 'Splash'\n        };\n\n        var message = {\n          endpoint: 'unlockJobs',\n          payload: {\n            jobRefs: ids\n          },\n          actions: [goToNext]\n        }\n\n        window.commsManager.addToQueue(message);\n        window.commsManager.processQueue();\n\n        cti.utils.callAction('call-function', { \"name\": \"startSpinner\" });\n      }\n      else {\n        // All okay to logout\n        window.plugins.zumo.logout(function() { \n          console.log('Logout success');\n          delete window.localStorage.logoutInitiated;\n          window.cti.utils.callAction('go-to-page', 'Splash');\n        }, \n        function(r) { console.log('Logout fail') });\n      }\n    }\n    else {\n      // Start reconcile process\n      document.getElementById('popJobsRemaining').togglePopup();\n    }\n  }\n  else {\n    window.commsManager.processQueue();\n    cti.utils.callAction('call-function', { \"name\": \"startSpinner\" });\n  }\n}\n"},"_auto_id_":"3a66a40d-0c51-47f7-97c6-228eef2b249b"}]},{"name":"item_0e440191","type":"control","item-type":"button","_auto_id_":"7a8c7a1f-b3fa-499a-b9eb-c001640d8dfa","content":"No","theme":"default","left-icon":"fa-times","expressions":{},"classes":"red","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popLogoutConfirm"}},"_auto_id_":"8ae8a152-6c79-4c32-b62f-25ead65b3c9d"}]}],"component":"CTPopupBox","_auto_id_":"af7cfc25-ae11-4d1f-a71b-69b0def421be","attributes":{"id":"popLogoutConfirm"},"expressions":{},"actions":[]},{"name":"popJobsRemaining","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlJobsRemaining","type":"content","item-type":"html","_auto_id_":"acd75f18-1ee3-47af-a884-440797f831d1","content":"<p>You still have some jobs completed on the device which haven't been returned to the server. The app will now try to send these back.</p>","expressions":{}},{"name":"btnRemainingOkay","type":"control","item-type":"button","_auto_id_":"d6af7fa2-3930-4c20-8ddb-a7a0fa3f53e0","content":"Okay","theme":"default","expressions":{},"left-icon":"fa-check","classes":"green","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.store.messageQueue = [];\n\nvar remainingJobs = [];\n\nfor(var i = 0; i < cti.store.completedJobs.length; i++) {\n  if(cti.store.completedJobs[i].responseReceived !== true) {\n    remainingJobs.push(cti.store.completedJobs[i]);\n  }\n}\n\nif(remainingJobs.length > 0) {\n  localStorage.reconciling = 'true';\n  \n  for(var j = 0; j < remainingJobs.length; j++) {\n    var currentJob = remainingJobs[j];\n    \n    if(currentJob.EvidencePhotos !== undefined) {\n      if(currentJob.EvidencePhotos.length > 0) {  \n        for(var i = 0; i < currentJob.EvidencePhotos.length; i++) {\n      \n          var evidence = {\n            JobId: currentJob.Id,\n            Timestamp: moment().format(),\n            Longitude: 0,\n            Latitude: 0\n          }\n\n          if(currentJob.EvidencePhotos[i].type === 'photo') {\n            var fileName = currentJob.JobRef + '_' + (i + 1);\n            evidence.fileName = fileName;\n            evidence.EvidenceType = 'jobPhoto';\n            evidence.photoRef = currentJob.EvidencePhotos[i].img;\n          }\n          else {\n            var fileName = currentJob.JobRef + '_' + 'Sig';\n            evidence.fileName = fileName;\n            evidence.EvidenceType = 'jobSignature';\n            evidence.sigRef = currentJob.EvidencePhotos[i].img;\n          }\n\n          var evidenceMsg = {\n            endpoint: 'sendEvidence',\n            payload: evidence \n          }\n\n          window.commsManager.addToQueue(evidenceMsg);\n        }\n      }\n    }\n\n    var message = {\n      endpoint: 'updateJob',\n      payload: currentJob \n    }\n\n    window.commsManager.addToQueue(message);\n  }\n  \n  cti.utils.callAction('call-function', { \"name\": \"startSpinner\" });\n  \n  window.commsManager.processQueue();\n}\n\nthis.$success();"},"_auto_id_":"4274f5c4-5a28-4c9c-a8dd-a0a01683f3ee"},{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popJobsRemaining"}},"_auto_id_":"ba007a8f-7681-4a4c-8435-7b228817c999"}]}],"component":"CTPopupBox","_auto_id_":"fd64e229-c944-4598-8230-cb9e3290ec91","attributes":{"id":"popJobsRemaining"},"expressions":{}},{"name":"popReconcileSuccess","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlReconcileSuccess","type":"content","item-type":"html","_auto_id_":"883d8101-0e8f-4a9a-98e0-76c78369047d","content":"<p>The reconcile process has completed successfully. You are now free to logout or change neighbourhood.</p>","expressions":{}},{"name":"btnReconcileSuccessOkay","type":"control","item-type":"button","_auto_id_":"c7602ff7-53e2-485a-84e1-de35564d6f9f","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popReconcileSuccess"}},"_auto_id_":"ec26f434-ca12-4b8c-9096-8eb8ad5ecc0f"}]}],"component":"CTPopupBox","_auto_id_":"42793403-d101-415e-a964-0b3bebe030cc","attributes":{"id":"popReconcileSuccess"},"actions":[],"expressions":{}},{"name":"popReconcileFail","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlReconcileFail","type":"content","item-type":"html","_auto_id_":"1c117a4a-a5ae-4fab-8be9-5c2bd0d4c51f","content":"<p>Reconcile has failed. Please try again.</p>","expressions":{}},{"name":"btnReconcileFailOkay","type":"control","item-type":"button","_auto_id_":"48ac9328-e8d4-4943-932b-eb0fa9480a06","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popReconcileFail"}},"_auto_id_":"b1e2a1f5-6242-47c1-9796-239946f1359d"}]}],"component":"CTPopupBox","_auto_id_":"fe96ad0f-4560-4adb-822b-922fbe03e8c3","attributes":{"id":"popReconcileFail"},"expressions":{}},{"name":"popAllComplete","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlAllComplete","type":"content","item-type":"html","_auto_id_":"64dfbff4-62ff-4395-b137-40d2129cef6b","content":"<p>You have completed all the jobs on the device. What would you like to do?</p>","expressions":{}},{"name":"btnMoreJobs","type":"control","item-type":"button","_auto_id_":"3b8928e0-f124-4428-8edf-53b180b7ad34","content":"Request More Jobs","theme":"default","left-icon":"fa-plus-circle","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":"RequestJobs","_auto_id_":"4423db44-7b48-4bdf-a44c-5de3f59e6f73"}],"classes":"green"},{"name":"btnChangeNeigh","type":"control","item-type":"button","_auto_id_":"64b5e02e-01c6-45a9-a36e-59ed3c89a263","content":"Change Neighbourhood","theme":"default","left-icon":"fa-map","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"// Check to see if for all completed jobs we have received a confirmation response from the server\nvar allResReceived = true;\n\nif(cti.store.completedJobs !== undefined) {\n  for(var i = 0; i < cti.store.completedJobs.length; i++) {\n    if(cti.store.completedJobs[i].responseReceived !== true) {\n      allResReceived = false;\n    }\n  }\n}\n\n// All responses received\nif(allResReceived) {\n  // Action to complete after messages sent\n  var goToNext = {\n    event: 'success',\n    type: 'go-to-page',\n    data: 'PatchSelect'\n  };\n  \n  // Get updated neighbourhood list message\n  var getNeighbourhood = {\n    endpoint: 'getNeighbourhoodDropdown',\n    payload: {\n      temp: 'temp'\n    },\n    logout: false,\n    actions: [goToNext]\n  };\n  \n  // Add to comms queue\n  delete cti.store.azureAppServices.azureEtfService.getNeighbourhoodDropdown;\n  delete cti.store.fromStart;\n  window.commsManager.addToQueue(getNeighbourhood);\n  window.commsManager.processQueue();\n  \n  // Start spinner\n  cti.utils.callAction('call-function', { \"name\": \"startSpinner\" });\n  document.getElementById('popAllComplete').togglePopup();\n}\nelse {\n  // Start reconcile process\n  document.getElementById('popAllComplete').togglePopup();\n  document.getElementById('popJobsRemaining').togglePopup();\n}"},"_auto_id_":"7f57facf-c12f-492a-b23b-df809fe79026"}],"classes":"green"},{"name":"btnFinalLogout","type":"control","item-type":"button","_auto_id_":"29916d37-6c39-494e-af69-710b07ccc44b","content":"Log out","theme":"default","left-icon":"fa-sign-out","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var allResReceived = true;\n  \nif(cti.store.completedJobs !== undefined) {\n    for(var i = 0; i < cti.store.completedJobs.length; i++) {\n        if(cti.store.completedJobs[i].responseReceived !== true) {\n            allResReceived = false;\n        }\n    }\n}\n  \nif(allResReceived) {\n    window.plugins.zumo.logout(function() { \n      console.log('Logout success');\n      window.cti.utils.callAction('go-to-page', 'Splash');\n    }, \n    function(r) { console.log('Logout fail') });\n}\nelse {\n    document.getElementById('popAllComplete').togglePopup();\n    document.getElementById('popJobsRemaining').togglePopup();\n}"},"_auto_id_":"c6190165-e0da-4636-8287-29db76e61363"}],"classes":"red"}],"component":"CTPopupBox","_auto_id_":"5f341a3b-9117-4f60-ac87-0df5a32ec88f","attributes":{"id":"popAllComplete"},"expressions":{}}],"expressions":{},"_auto_id_":"f75e8277-35f1-4608-9f0a-a44bda37cc07"}]},{"name":"JobDetail","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"setTimeout(function() {\n  if(cti.store.currentJob.ArrivalTime === null) {\n    $('div#btnArrive').attr('classes', '');\n    $('div#btnComplete').attr('classes', 'ng-hide');\n  }\n  else {\n    $('div#btnArrive').attr('classes', 'ng-hide');\n    $('div#btnComplete').attr('classes', '');\n  }\n}, 200);"},"_auto_id_":"72ff5b91-7754-42fc-8335-4e96eecca372"}],"_auto_id_":"ffb52f88-01c9-4d24-9f7b-231c730ff618"}],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"eeaf525f-fa3c-4d14-ad3c-9b1b5f79fd14","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}},{"name":"btnMenu","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"right-icon":"fa-bars","actions":[{"name":"call_function_1","event":"click","type":"call-function","data":{"name":"openContextMenu"},"_auto_id_":"121493f3-da6c-4219-a64b-49f1543540c1"}],"_auto_id_":"329ef3c3-0a1f-4748-82f5-19c512142030"}],"_auto_id_":"3a95aaec-0d95-44cf-a417-ca96d0661f19"},{"name":"staticJobDetail","type":"area","item-type":"static","content":[{"name":"htmlJobDetail","type":"content","item-type":"html","content":"<h2>Current Job (from {{'$store.currentPatch' | store}})</h2>\n\n<div class=\"jobRow full\">\n  <div class=\"jobCell full address\">\n    <p class=\"sla\" data-sla=\"{{'$store.currentJob.SLA' | store}}\" data-sla-threshhold=\"{{'$store.currentJob.SLAThreshhold' | store}}\">SLA: {{'$store.currentJob.SLADisplay' | store}} <span class=\"sla-message\"></span></p>\n    <p class=\"name\">{{'$store.currentJob.JobRef' | store}}; {{'$store.currentJob.JobCategory' | store}}</p>\n    <p>{{'$store.currentJob.CustomerName' | store}}</p>\n    <p>{{'$store.currentJob.SingleLineAddress' | store}}</p>\n    <p class=\"contact\">{{'$store.currentJob.Phone' | store}}<p>\n  </div>\n</div>\n\n","expressions":{},"_auto_id_":"03b7984d-9e60-4579-bc6e-e234382a7096"},{"name":"htmlJobArrived","type":"content","item-type":"html","content":"<div class=\"jobRow full\">\n  <div class=\"jobArrived\">\n    <span>Arrived at: <strong>{{'$store.currentJob.ArrivalTimeDisplay' | store  | date : 'medium'}}</strong></span>\n  </div>\n</div>","expressions":{"show":"$store.currentJob.ArrivalTime !== null"},"_auto_id_":"ecb28738-db8f-4293-897f-54322a607c4b"}],"expressions":{},"_auto_id_":"9227234d-cbd9-4b24-9ec8-52187f87ab43"},{"name":"scrollableJobNotes","type":"area","item-type":"scrollable","_auto_id_":"558f8bf3-10a5-49dd-a8b7-1792997270f5","content":[{"name":"htmlJobNotes","type":"content","item-type":"html","content":"<h2>Summary</h2>\n\n<div class=\"jobNotes\">\n\t<p>{{'$store.currentJob.Summary' | store}}</p>\n</div>","expressions":{},"_auto_id_":"593446cc-efa4-47ea-96b0-3868a1a06d34"}],"expressions":{}},{"name":"staticContextMenu","type":"area","item-type":"static","content":[{"name":"jobDetailMenu","type":"component","item-type":"web-component-es2015","template":"<ct-context-menu></ct-context-menu>","content":[{"name":"btnPhoto","type":"control","item-type":"button","_auto_id_":"f6185399-93c8-4edc-8010-00b54994b17d","content":"Photos","theme":"default","expressions":{},"left-icon":"fa-camera","actions":[{"event":"click","type":"go-to-page","data":"Photos","_auto_id_":"b471bf0f-d795-4abd-a7a5-5b0088bed44c"}]},{"name":"btnSignature","type":"control","item-type":"button","_auto_id_":"47469b30-9239-408d-9242-d6ee4e6d86b7","content":"Get Signature","theme":"default","left-icon":"fa-edit","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":"Signature","_auto_id_":"0f487cff-59d5-424f-9299-db4ca57c6be2"}]},{"name":"btnNavigateToJob","type":"control","item-type":"button","_auto_id_":"7aa48d8a-9390-4e5c-b613-96de2743a8ab","content":"Navigate to job","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var destination =\ncti.store.currentJob.SingleLineAddress;\ncti.utils.callAction(\"call-url\", {\"name\":\"AppleMaps\",\"params\":{\"daddr\":destination}});\nthis.$success();"},"_auto_id_":"86d8921e-12a3-4f63-96b0-01c8490b889c","actions":[]}],"left-icon":"fa-map-pin"},{"name":"btnAddNotes","type":"control","item-type":"button","_auto_id_":"326b1b1f-d32a-486e-9ca7-6bf0ae7ae839","content":"Add notes about job","theme":"default","expressions":{},"left-icon":"fa-edit","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popJobNotes"}},"_auto_id_":"dfa74d5e-5b2a-4779-9441-5937829a3854"}]}],"component":"CTContextMenu","_auto_id_":"e5bb188f-760e-46ca-b773-9bafeedb73f1","attributes":{},"expressions":{},"actions":[]},{"name":"popCompleteJob","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlCompleteJob","type":"content","item-type":"html","_auto_id_":"fda62813-30fd-4071-9208-1424d628fbfb","content":"<p>Would you like to mark this job as completed?</p>","expressions":{}},{"name":"btnCompleteYes","type":"control","item-type":"button","_auto_id_":"850bc549-5f89-4de3-87dd-a7465a698db3","content":"Yes","theme":"default","expressions":{},"left-icon":"fa-check","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var currentJob = cti.store.currentJob;\ncurrentJob.CompletionDate = moment().format('YYYY-MM-DD HH:mm:ss');\ncurrentJob.Completed = true;\ncurrentJob.Status = 'Success';\ncurrentJob.Reason = null;\ncurrentJob.FailDetail = null;\ncurrentJob.responseReceived = false;\nif (cti.store.pages.JobDetail !== undefined && cti.store.pages.JobDetail.txtCompletionNotes !== undefined) {\n\tcurrentJob.Notes = cti.store.pages.JobDetail.txtCompletionNotes;\n}\n\ncti.addJobEvidence(currentJob);\n\nvar message = {\n  endpoint: 'updateJob',\n  payload: currentJob \n};\n\nif(window.commsManager === undefined) {\n\twindow.commsManager = new CommsManager();\n}\n\nwindow.commsManager.addToQueue(message);\ncti.store.completedJobs.push(currentJob);\ndelete cti.store.currentJob;\nif (cti.store.pages.JobDetail !== undefined && cti.store.pages.JobDetail.txtCompletionNotes !== undefined) {\n\tdelete cti.store.pages.JobDetail.txtCompletionNotes;\n}\ncti.store.remainingJobCount = cti.store.azureAppServices.azureEtfService.getJobs.length;\n\nif(cti.store.pages.Signature !== undefined) {\n  if(cti.store.pages.Signature.sigJobSig !== undefined) {\n    delete cti.store.pages.Signature.sigJobSig;\n  }\n}\n\nwindow.commsManager.processQueue();\n\ncti.utils.callAction('go-to-page', 'JobList');\n\nthis.$success();"},"_auto_id_":"4eacf8bd-b1d3-4996-ae94-c492ad2985fd","actions":[]},{"event":"click","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"jobFinished","title":"Job Completed","text":"Job completed successfully. Now attempting to return job data."},"_auto_id_":"81e87370-9931-4bbd-915a-9962812fdeb7"}],"classes":"green"},{"name":"btnCompleteNo","type":"control","item-type":"button","_auto_id_":"5a1f930c-c63b-4910-be17-030a5a22d79f","content":"No","theme":"default","left-icon":"fa-times","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popCompleteJob"}},"_auto_id_":"fe550675-a3c8-47d8-9dfc-553b846e9d7d"}],"expressions":{},"classes":"red"}],"component":"CTPopupBox","_auto_id_":"11bdf44b-16e2-483f-a9d5-45fe1a2a07bc","attributes":{"id":"popCompleteJob"},"expressions":{},"actions":[]},{"name":"popJobNotes","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlEnterNotes","type":"content","item-type":"html","_auto_id_":"94068aaa-886e-4fa2-ac82-44be3eccd0c4","content":"<p>Please enter any further notes you may have</p>","expressions":{}},{"name":"txtCompletionNotes","type":"question","item-type":"text","_auto_id_":"a9eab193-db4e-4c4b-92a1-36e9fedc09ca","label":"","required":false,"multiline":true,"debounce":250,"expressions":{}},{"name":"btnCompleteNo","type":"control","item-type":"button","_auto_id_":"bbfd5eab-d549-4351-887c-3b05c678538d","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popJobNotes"}},"_auto_id_":"1954a521-7923-4f43-b870-504c284ae615"}],"expressions":{},"classes":"green"}],"component":"CTPopupBox","_auto_id_":"16ff0117-086a-41f1-9b7b-65d305bdfa3d","attributes":{"id":"popJobNotes"},"expressions":{},"actions":[]}],"expressions":{},"_auto_id_":"58a2b226-a9bd-4952-8b12-5c68ab2e8412"},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnFail","type":"control","item-type":"button","content":"Fail Job","theme":"default","expressions":{},"classes":"","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"FailJob","_auto_id_":"2fb2170c-56d2-48cc-9467-603c53de2bb6"}],"_auto_id_":"2f026d63-03fe-44f0-a5e0-c649a5094b0c"},{"name":"btnArrive","type":"control","item-type":"button","content":"Arrived at Job","theme":"default","expressions":{},"actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"cti.store.currentJob.ArrivalTime = moment().format('YYYY-MM-DD HH:mm:ss');\ncti.store.currentJob.ArrivalTimeDisplay = moment().format('DD/MM/YY HH:mm:ss');\n\n$('div#btnArrive').attr('classes', 'ng-hide');\n$('div#btnFail').attr('classes', '');\n$('div#btnComplete').attr('classes', '');"},"_auto_id_":"cc5c804c-5d9c-4fb1-8f89-d6878fafab51"}],"classes":"","_auto_id_":"b16f760f-60b3-4ab6-ab51-4d192f2cc2e1"},{"name":"btnComplete","type":"control","item-type":"button","content":"Complete Job","theme":"default","expressions":{},"classes":"","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popCompleteJob"}},"_auto_id_":"9382509c-a472-4543-adf6-dd908137b285"}],"_auto_id_":"77511bb6-9609-4d24-b806-7a9fbc6a0717"}],"_auto_id_":"84ad35c8-8ba6-4efd-bd20-7b4269a7a8e1","expressions":{}}]},{"name":"Photos","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"event":"onload","type":"inline-function","data":{"code":"window.deletePhotoFromJob = function(e) {\n  localStorage.photoToDelete = e.currentTarget.getAttribute('index');\n  var popup = document.getElementById('popDeletePhoto');\n  popup.togglePopup();\n}\n\nsetTimeout(function() {\n  var currentJob = cti.store.currentJob;\n\n  if(currentJob.EvidencePhotos !== undefined) {\n    for(var i = 0; i < currentJob.EvidencePhotos.length; i++) {\n      if(currentJob.EvidencePhotos[i].type === 'photo') {\n        // Construct HTML List item\n        var jobRow = document.createElement('div');\n        jobRow.className = 'jobRow photo';\n        jobRow.id = 'photo' + currentJob.EvidencePhotos[i].id;\n        \n        if(i === 0) {\n          jobRow.className += ' borderTop';\n        }\n        \n        var jobRowCellImage = document.createElement('div');\n        jobRowCellImage.className = 'jobCell image';\n        \n        var jobRowCellButton = document.createElement('div');\n        jobRowCellButton.className = 'jobCell button';\n        jobRowCellButton.setAttribute('index', currentJob.EvidencePhotos[i].id);\n        jobRowCellButton.onclick = window.deletePhotoFromJob;\n        \n        var jobRowCellImageImg = document.createElement('img');\n        jobRowCellImageImg.width = 131;\n        jobRowCellImageImg.height = 175;\n        jobRowCellImageImg.src = currentJob.EvidencePhotos[i].img;\n        \n        var jobRowCellButtonP = document.createElement('p');\n        \n        jobRowCellImage.appendChild(jobRowCellImageImg);\n        jobRowCellButton.appendChild(jobRowCellButtonP);\n        \n        jobRow.appendChild(jobRowCellImage);\n        jobRow.appendChild(jobRowCellButton);\n        \n        // Add to page\n        var container = document.querySelector('#htmlPhotoList > div');\n        container.appendChild(jobRow);\n      }\n    }\n  }\n}, 200);\n  "},"_auto_id_":"e8a666e6-b28d-4f2e-a6f1-8bd999df9ac8"}],"_auto_id_":"9a44d608-1cc4-49ab-9dff-4af8935685ee"}],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobDetail","_auto_id_":"b84defb0-b58a-4b6c-a950-ce2b52a34b70"}],"_auto_id_":"466522c6-1ffe-4ce6-a4bc-c4dd80b138cd"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"c6837b0d-8857-45e8-b445-8a77590a7a05","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"7494690d-2ee4-4379-bb11-debc77be4545"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlPhotoList","type":"content","item-type":"html","content":"<h2>Job Photos</h2>","expressions":{},"_auto_id_":"3e7168fa-97d9-46ad-8324-a146da3f896b"}],"expressions":{},"_auto_id_":"8d2c1348-692e-4cdb-8578-9fc940b3e7b4"},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnTakePhoto","type":"control","item-type":"button","content":"Take Photo","theme":"default","actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var currentJob = cti.store.currentJob;\ndebugger;\nif(currentJob.EvidencePhotos === undefined) {\n  currentJob.EvidencePhotos = [];\n}\n\nvar length = 0;\n\nfor(var i = 0; i < currentJob.EvidencePhotos.length; i++) {\n  if(currentJob.EvidencePhotos[i].type === 'photo') {\n    length++;\n  }\n}\n\nif(length < 3) {\n  window.navigator.camera.getPicture(onCameraSuccess, onCameraError, {\n    quality: 75,\n    destinationType: 1,\n    sourceType: 1,\n    allowEdit: false,\n    encodingType: 0,\n    saveToPhotoAlbum: false,\n    correctOrientation: true,\n    targetWidth: 720,\n    targetHeight: 1280,\n    cameraDirection: 0\n  }); \n}\nelse {\n  var popup = document.getElementById('popPhotoError');\n  popup.togglePopup();\n}\n\nfunction onCameraSuccess(img) {\n  console.log('CAMERA RESULT: %s', img);\n  movePhoto(img);\n}\n\nfunction onCameraError(r) {\n  console.log('CAMERA ERROR: %s', r);\n}\n\nfunction movePhoto(file) {\n  console.log(file);\n  window.resolveLocalFileSystemURI(file , resolveOnSuccess, resOnError);\n}\n\nfunction resolveOnSuccess(entry) {\n  var d = new Date();\n  var n = d.getTime();\n\n  //new file name\n  var newFileName = n + \".jpg\";\n  var myFolderApp = \"my_folder\";\n\n  window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSys) {\n    fileSys.root.getDirectory(myFolderApp, { create: true }, function(directory) {\n      entry.moveTo(directory, newFileName, function(new_entry) {\n        path = new_entry.fullPath;\n        url = new_entry.toURL();\n\n        console.log(path+\"\\n\"+url);\n\n        var currentJob = cti.store.currentJob;\n  \n        if(currentJob.EvidencePhotos.length === 0) {\n          var index = 0;\n        }\n        else {\n          var index = currentJob.EvidencePhotos[currentJob.EvidencePhotos.length - 1].id + 1;\n        }\n        \n        var imgObj = {\n          id: index,\n          type: 'photo',\n          img: url\n        };\n        \n        currentJob.EvidencePhotos.push(imgObj);\n        \n        // Construct HTML List item\n        var jobRow = document.createElement('div');\n        jobRow.className = 'jobRow photo';\n        jobRow.id = 'photo' + index;\n        \n        if(currentJob.EvidencePhotos.length === 1) {\n          jobRow.className += ' borderTop';\n        }\n        \n        var jobRowCellImage = document.createElement('div');\n        jobRowCellImage.className = 'jobCell image';\n        \n        var jobRowCellButton = document.createElement('div');\n        jobRowCellButton.className = 'jobCell button';\n        jobRowCellButton.setAttribute('index', index);\n        jobRowCellButton.onclick = window.deletePhotoFromJob;\n        \n        var jobRowCellImageImg = document.createElement('img');\n        jobRowCellImageImg.width = 131;\n        jobRowCellImageImg.height = 175;\n        jobRowCellImageImg.src = imgObj.img;\n        \n        var jobRowCellButtonP = document.createElement('p');\n        \n        jobRowCellImage.appendChild(jobRowCellImageImg);\n        jobRowCellButton.appendChild(jobRowCellButtonP);\n        \n        jobRow.appendChild(jobRowCellImage);\n        jobRow.appendChild(jobRowCellButton);\n        \n        // Add to page\n        var container = document.querySelector('#htmlPhotoList > div');\n        container.appendChild(jobRow);\n        cti.utils.updatePage();\n      }, \n      resOnError);\n    },\n    resOnError);\n  },\n  resOnError);\n}\n\nfunction resOnError(error) {\n  alert('Error '+error.code+': '+error.message);\n}"},"_auto_id_":"65525527-6405-4bba-bfc9-ffebdf8f7930"}],"expressions":{},"_auto_id_":"7fb4dd9e-d645-4b18-8a50-639299b9ead6"}],"_auto_id_":"ccc546a4-d5c6-465d-b234-c973c80217db"},{"name":"staticComponentCont","type":"area","item-type":"static","content":[{"name":"popPhotoError","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlPhotoError","type":"content","item-type":"html","_auto_id_":"f49b1ce4-3763-4cc2-9a9f-890cc425dc93","content":"<p>You can only take a maximum of 3 photos per job. Please delete at least one photo first.</p>","expressions":{}},{"name":"btnbPhotoErrOkay","type":"control","item-type":"button","_auto_id_":"0fc85185-9f7a-42ca-9f08-b782dcef0b38","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popPhotoError"}},"_auto_id_":"d475d5e2-8fe8-4ca9-a411-64bec8de4647"}],"expressions":{},"classes":"green"}],"component":"CTPopupBox","_auto_id_":"d8e358ee-1270-4c03-8e0c-97c7c140104c","attributes":{"id":"popPhotoError"},"expressions":{},"actions":[]},{"name":"popDeletePhoto","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlPhotoDelete","type":"content","item-type":"html","_auto_id_":"67d1dd21-e2ca-4f3e-a584-b2c960f17586","content":"<p>Are you sure you wish to delete this photo from the job?</p>","expressions":{}},{"name":"btnDeleteYes","type":"control","item-type":"button","_auto_id_":"59b08b9a-81b9-4328-82aa-7a09f0ea57bf","content":"Yes","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"var index = parseInt(localStorage.photoToDelete);\nvar currentJob = cti.store.currentJob;\n\nfor(var i = 0; i < currentJob.EvidencePhotos.length; i++) {\n    if(index == currentJob.EvidencePhotos[i].id && currentJob.EvidencePhotos[i].type === 'photo') {\n      currentJob.EvidencePhotos.splice(i, 1);\n      break;\n    }\n}\n\nvar jobRow = document.querySelector('#photo' + index);\njQuery(jobRow).remove();\n\nvar popup = document.getElementById('popDeletePhoto');\npopup.togglePopup();"},"_auto_id_":"955dc0e1-e6cf-4236-ace1-49de6e8261b2"}],"expressions":{},"classes":"green"},{"name":"btnDeleteNo","type":"control","item-type":"button","_auto_id_":"59479c80-1a32-44af-850e-a0e6e96494c9","content":"No","theme":"default","left-icon":"fa-times","expressions":{},"classes":"red","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popDeletePhoto"}},"_auto_id_":"aca4dfee-5167-4536-b51c-c9ee7c0b0485"}]}],"component":"CTPopupBox","_auto_id_":"1eb4a0dd-9e4c-478e-83ac-d3ae70b46f4d","attributes":{"id":"popDeletePhoto"},"expressions":{}}],"expressions":{},"_auto_id_":"c685a902-ce04-4d59-852e-bfa6cf15e99d"}]},{"name":"Signature","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"name":"inline_function_1","event":"onload","type":"inline-function","data":{"code":"if(1 == 2) {\n  setTimeout(function() {\n    var canvas = document.getElementsByTagName('canvas')[0];\n    canvas.width = window.innerWidth;\n\n    if(cti.store.pages.Signature.sigJobSig !== undefined) {\n      var sig = new SignaturePad(document.getElementsByTagName('canvas')[0]);\n\n      sig.fromDataURL(cti.store.pages.Signature.sigJobSig);\n    }\n  }, 200);\n}"},"_auto_id_":"5490fa0e-e5d9-4daa-9a4f-6652b0c43362"}],"_auto_id_":"d82c2eb3-22bf-4c4e-ae96-1aa2de20ac70"}],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobDetail","_auto_id_":"e493b119-ae79-48c0-a929-aa1657dd0bf3"}],"expressions":{},"_auto_id_":"ab7ef66a-7143-4941-bc97-03959c4553fa"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"b8ae7af5-212f-415d-9df2-f511094a1557","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"a2c0af22-4ec7-4519-9628-3c74346a2a68"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"sigJobSig","type":"question","item-type":"signature","label":"","required":false,"expressions":{},"validators":[],"actions":[],"_auto_id_":"f514faf9-0b9f-4a07-b483-21d6a5f3011d"}],"_auto_id_":"b298b1bf-7a51-4b2c-9de6-0a6fd3ee39de"},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnConfirm","type":"control","item-type":"button","content":"Confirm","theme":"default","expressions":{},"actions":[{"event":"click","type":"inline-function","data":{"code":"if(cti.store.pages.Signature !== undefined) {\n  if(cti.store.pages.Signature.sigJobSig !== undefined) {\n    var currentJob = cti.store.currentJob;\n\n    if(currentJob.EvidencePhotos === undefined) {\n      currentJob.EvidencePhotos = [];\n    }\n\n    var sigData = cti.store.pages.Signature.sigJobSig.substring(16)\n\n    var imgObj = {\n      id: 999,\n      type: 'signature',\n      img: sigData\n    };\n\n    currentJob.EvidencePhotos.push(imgObj)\n  } \n}"},"_auto_id_":"45d01b4a-82c5-42e0-b217-2bcb005240ef"},{"name":"go_to_page_1","event":"click","type":"go-to-page","data":"JobDetail","_auto_id_":"ebfd3639-2f54-48c8-aaf1-83e6ff470d8c"}],"_auto_id_":"8c5ba360-f06c-43bd-b262-6fda3d4c3fbd"}],"_auto_id_":"bbcae9f8-cba6-43cf-8a18-2c98585258ab"}]},{"name":"PatchSelect","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","actions":[{"event":"click","type":"inline-function","data":{"code":"var popup = document.getElementById('popLogout');\npopup.togglePopup(); "},"_auto_id_":"b2dadce4-8167-47de-9902-eca2475cb7f0","actions":[]}],"expressions":{},"_auto_id_":"85dd5d93-3a2b-443f-a512-555651412791"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"558c1cfe-d7f6-4fe5-850a-a899e7471ec3","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"b1b405da-e46a-4b34-a787-7880c333b25a","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"drpPatchSelect","type":"question","item-type":"select","label":"Select Neighbourhood","required":true,"options":[{"label":"Option 1","value":1},{"label":"Option 2","value":2},{"label":"WEEE","value":3}],"expressions":{},"message":"This is a required field","option-source":"$store.azureAppServices.azureEtfService.getNeighbourhoodDropdown.res","validators":[],"actions":[],"label-property":"label","value-property":"value","_auto_id_":"b0b90a95-d520-4fb5-9b4b-cbc3983c6052"},{"name":"rdoAllJobs","type":"question","item-type":"radio","_auto_id_":"b56b1706-88c6-441e-b3da-b71933824c8e","label":"","required":false,"options":[{"label":"RRT","value":"1"},{"label":"Clean","value":"0"}],"icon-selected":"fa-check-square-o","icon-unselected":"fa-square-o","expressions":{"default":"\"1\""},"validators":[],"actions":[],"description":""}],"_auto_id_":"2a1c9c2c-cb81-4ddc-8602-8c7e8002ddec"},{"name":"staticShiftStats","type":"area","item-type":"static","_auto_id_":"3363755b-716a-4cbd-8a14-c79cea8ed05b","content":[{"name":"htmlShiftStats","type":"content","item-type":"html","_auto_id_":"3b47b6b9-e2d9-4232-a70d-b2f1b2c22bde","content":"<div class=\"box\" md-actions='[{\"name\":\"go_to_page_2\",\"event\":\"click\",\"type\":\"go-to-page\",\"data\":\"ShiftReview\"}]'>\n  <h3><span>{{'$store.completedJobs.length' | store}}</span><br>Completed jobs (this session)</h3>\n</div>","expressions":{}}],"expressions":{}},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnNext","type":"control","item-type":"button","content":"Request Jobs","theme":"default","expressions":{"disabled":"$store.pages.PatchSelect.drpPatchSelect.value === undefined"},"actions":[{"event":"click","type":"call-function","data":{"name":"startSpinner"},"_auto_id_":"e4654af4-c7db-47b0-ae4c-951a1bbef192"},{"name":"inline_function_2","event":"click","type":"inline-function","data":{"code":"delete cti.store.jobList;\ncti.store.currentPatch = cti.store.pages.PatchSelect.drpPatchSelect.value;"},"_auto_id_":"559790d5-5f3f-426d-860c-d7b9fb1370f6","actions":[]},{"event":"click","type":"call-azure-app-service","data":{"name":"azureEtfService","operation":"getJobs","params":{"neighbourhood":"{{$store.pages.PatchSelect.drpPatchSelect.value}}","numberToGet":"30","allJobs":"{{$store.pages.PatchSelect.rdoAllJobs}}"}},"_auto_id_":"36f9b938-a72f-409b-86f6-6fd3e35d1cc5","actions":[{"event":"fail","type":"call-function","data":{"name":"stopSpinner"},"_auto_id_":"0f00ca7d-0de2-45f5-a6c0-61d3bc9dc814"},{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"requestFailed"},"_auto_id_":"5fb83c54-2aa9-4100-ba3d-997c5225429f"},{"event":"success","type":"inline-function","data":{"sync":true,"code":"function pad(v) {\n  if (v < 10) { return \"0\" + v; } else { return v; }\n}\n\n// Update the last update message area\nvar dt = new Date();\ncti.store.lastSync = dt;\ncti.store.lastSyncDisplay = \n  pad(dt.getDate()) + \"/\" +\n  pad(dt.getMonth()+1) + \" @ \" +\n  dt.getHours() + \":\" +\n  pad(dt.getMinutes());\n\ncti.stopSpinner();\nif(cti.store.azureAppServices.azureEtfService.getJobs.length === 0) {\n  var popup = document.getElementById('popNoJobs');\n  popup.togglePopup();\n}\nelse {\n    for(var i = 0; i < cti.store.azureAppServices.azureEtfService.getJobs.length; i++) {\n      if(cti.store.azureAppServices.azureEtfService.getJobs[i].SLADisplay === undefined) {\n        cti.store.azureAppServices.azureEtfService.getJobs[i].SLADisplay = cti.fnFormatDate(cti.store.azureAppServices.azureEtfService.getJobs[i].SLA, '(none)');\n      }\n    }\n\n  // Retain our currently selected patch in case we need to do an implicit job list refresh later\n  cti.store.currentPatch = cti.store.pages.PatchSelect.drpPatchSelect.value;\n  cti.store.getAllJobs = cti.store.pages.PatchSelect.rdoAllJobs;\n  \n  delete cti.store.pages.PatchSelect.drpPatchSelect;\n  if (cti.store.completedJobs === undefined) {\n  \tcti.store.completedJobs = [];\n  }\n  cti.utils.callAction('go-to-page', 'JobList');\n}"},"_auto_id_":"820299e5-1829-43d0-b444-67953c637ead","actions":[]}]}],"_auto_id_":"18a2dd42-c328-4eb9-8faf-ead2510ecd89"}],"_auto_id_":"af86b243-3cab-447f-847f-3c11dae96afe","expressions":{}},{"name":"static_13","type":"area","item-type":"static","content":[{"name":"popNoJobs","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlNoJobs","type":"content","item-type":"html","_auto_id_":"8424cac6-f549-4fe0-8687-bcbaa1af130f","content":"<p>No jobs found for this neighbourhood. Please try another neighbourhood.</p>","expressions":{}},{"name":"btnNoJobsOkay","type":"control","item-type":"button","_auto_id_":"85b66a42-15b7-4fc3-9a1e-46c9ca8e7edc","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popNoJobs"}},"_auto_id_":"1cb5747f-b7ee-4607-8ec8-6e005f7d4dfe"}]}],"component":"CTPopupBox","_auto_id_":"528c7d41-3c2c-41df-8b33-d000e4749d03","attributes":{"id":"popNoJobs"},"expressions":{}},{"name":"popLogout","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlLogout","type":"content","item-type":"html","_auto_id_":"f674973c-7b9e-4dcd-87e4-1fedc719d41b","content":"<p>Would you like to logout?</p>","expressions":{}},{"name":"btnLogoutYes","type":"control","item-type":"button","_auto_id_":"e8cb9fd6-39ee-4f53-adbe-6f2c493562b2","content":"Yes","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"window.plugins.zumo.logout(function() { \n  console.log('Logout success');\n  window.cti.utils.callAction('go-to-page', 'Splash');\n}, \nfunction(r) { console.log('Logout fail') });"},"_auto_id_":"3a66a40d-0c51-47f7-97c6-228eef2b249b"}]},{"name":"btnLogoutNo","type":"control","item-type":"button","_auto_id_":"988f5eaa-e7cf-4a2f-8eb5-578aaab4f5be","content":"No","theme":"default","left-icon":"fa-times","expressions":{},"classes":"red","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popLogout"}},"_auto_id_":"8ae8a152-6c79-4c32-b62f-25ead65b3c9d"}]}],"component":"CTPopupBox","_auto_id_":"5b87ce20-2686-409e-b7f9-e415597f2e6d","attributes":{"id":"popLogout"},"expressions":{}},{"name":"ctps_loadpanel_2","type":"component","item-type":"web-component-es2015","template":"<ctps-loadpanel></ctps-loadpanel>","content":[],"component":"ctps_loadpanel","_auto_id_":"1f483007-2cbb-498f-ac39-a0f1976b7454"}],"_auto_id_":"35df6cd6-8862-4e61-90dd-b3add6a29469","expressions":{}}]},{"name":"FailJob","config":[{"name":"On-Load Event","type":"event","item-type":"onload","actions":[{"event":"onload","type":"inline-function","data":{"code":"setTimeout(function() {\n  if(cti.store.currentJob.Reason !== null) {\n    document.querySelector('a#btnSelectReason').textContent = cti.store.currentJob.Reason;\n  }\n}, 200);"},"_auto_id_":"74fd151d-6571-45a9-a716-e4db79c18fd4"}],"_auto_id_":"947454e3-8434-42b7-be72-dcb7b4da81b9"}],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"actions":[{"name":"go_back_1","event":"click","type":"go-back","data":{},"_auto_id_":"2fa63f03-e363-4831-bfc4-578e8131c1a8"}],"left-icon":"fa-arrow-left","_auto_id_":"7d73dabc-b8d6-41c6-9d2f-07dd639b5057"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"6c35475d-bc70-4fb4-bc6d-36ee90780bd8","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"33ecd557-0808-45bd-a602-4e64488c00cc"},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlHeading","type":"content","item-type":"html","content":"<h2>Fail Job</h2>","expressions":{},"_auto_id_":"1efc203d-824f-417d-a24b-b050b92ee771"},{"name":"btnSelectReason","type":"control","item-type":"button","content":"Select fail reason...","theme":"default","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popFailReason"}},"_auto_id_":"ed3e643c-7d99-416d-8a39-7ac641a8db82"}],"expressions":{},"_auto_id_":"13437b24-64c7-4f3f-a767-df9742211a88"},{"name":"txtFailMore","type":"question","item-type":"text","label":"More Information:","required":false,"multiline":true,"debounce":250,"expressions":{},"validators":[],"actions":[],"_auto_id_":"ef7f2fc1-252c-4f5e-af9e-f27abdf16d5f"}],"_auto_id_":"1cf23ada-dfbe-49fd-8a90-f82a19f56070"},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnFailConfirm","type":"control","item-type":"button","content":"Confirm","theme":"default","expressions":{},"actions":[{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"// Mark job as failed, etc\nvar currentJob = cti.store.currentJob;\nif (cti.store.pages.JobDetail !== undefined && cti.store.pages.JobDetail.txtCompletionNotes !== undefined) {\n\tcurrentJob.Notes = cti.store.pages.JobDetail.txtCompletionNotes;\n}\ncurrentJob.CompletionDate = moment().format('YYYY-MM-DD HH:mm:ss');\n\nif(currentJob.Reason === null) {\n  var popup = document.getElementById('popAddReason');\n  popup.togglePopup();\n}\nelse if(currentJob.Reason == 'Other' && cti.store.pages.FailJob === undefined) {\n  var popup = document.getElementById('addOther');\n  popup.togglePopup();\n}\nelse {\n  currentJob.Completed = true;\n  currentJob.Status = 'Failed';\n  currentJob.responseReceived = false;\n  \n  if(cti.store.pages.FailJob === undefined) {\n    currentJob.FailDetail = null;\n  }\n  else {\n    currentJob.FailDetail = cti.store.pages.FailJob.txtFailMore || null;\n  }\n  \n  cti.addJobEvidence(currentJob);\n  \n  var message = {\n    endpoint: 'updateJob',\n    payload: currentJob \n  }\n  \n  if(window.commsManager === undefined) {\n\twindow.commsManager = new CommsManager();\n  }\n\n  window.commsManager.addToQueue(message);\n\n  cti.store.completedJobs.push(currentJob);\n  delete cti.store.currentJob;\n  delete cti.store.pages.FailJob;\n  cti.store.remainingJobCount = cti.store.azureAppServices.azureEtfService.getJobs.length;\n\n  if(cti.store.pages.Signature !== undefined) {\n    if(cti.store.pages.Signature.sigJobSig !== undefined) {\n      delete cti.store.pages.Signature.sigJobSig\n    }\n  }\n  \n  window.commsManager.processQueue();\n  \n  cti.utils.callAction('go-to-page', 'JobList');\n  cti.utils.callAction('show-notification', {\"options\": { \"schedule\": false, \"dynamic\": true }, \"name\": \"jobFinished\", \"title\": \"Job Completed\", \"text\": \"Job marked as failed. Now attempting to return job data.\" });\n}"},"_auto_id_":"e373a671-459d-4813-a4a1-5db1f4b5ab92"}],"_auto_id_":"9125fa9a-d275-4943-87e0-35fb43b22a0c"}],"_auto_id_":"faf1fd09-1de3-4f54-89fb-e4e53a941eb6"},{"name":"static_14","type":"area","item-type":"static","content":[{"name":"popAddReason","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlSpecifyFail","type":"content","item-type":"html","_auto_id_":"46bfbfd1-3e80-43e8-bbbb-9cae3762c529","content":"<p>Please select a reason for failing this job.</p>","expressions":{}},{"name":"btnFailOkay","type":"control","item-type":"button","_auto_id_":"1e25207e-25ae-464e-972f-94826a9f54c6","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popAddReason"}},"_auto_id_":"707b7c74-8d52-4c63-acf2-9ad4da00a2ee"}]}],"component":"CTPopupBox","_auto_id_":"bea2e3b3-c2c9-4f2c-8094-8ca9896282ee","attributes":{"id":"popAddReason"},"expressions":{},"classes":""},{"name":"popAddOther","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlAddOther","type":"content","item-type":"html","_auto_id_":"f5bdb382-1ce7-494e-a7c3-8f39f030f2ef","content":"<p>Please add more information when selecting 'other'.</p>","expressions":{}},{"name":"btnOtherOkay","type":"control","item-type":"button","_auto_id_":"aa20a3cd-0c49-48df-b12f-3ff96ab337eb","content":"Okay","theme":"default","left-icon":"fa-check","expressions":{},"classes":"green","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popAddOther"}},"_auto_id_":"eb77c42c-2178-4698-86d6-7773a28a7069"}]}],"component":"CTPopupBox","_auto_id_":"db8dc080-f3a5-4535-be42-565422f60bd9","attributes":{"id":"popAddOther"},"expressions":{}},{"name":"popFailReason","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlFail","type":"content","item-type":"html","_auto_id_":"373261c8-91b5-4593-905c-5346d41d8bb5","content":"<p>Please select a fail reason:</p>","expressions":{}},{"name":"btnFail1","type":"control","item-type":"button","_auto_id_":"008efe29-99fe-4e8b-965f-00baeab1c12a","content":"Job already complete","theme":"default","expressions":{},"actions":[{"event":"click","type":"call-function","data":{"name":"setFailReason","params":{"reason":"Job already complete"}},"_auto_id_":"5d20b10c-f85e-4e64-8795-32d67ba52467"}]},{"name":"btnFail2","type":"control","item-type":"button","_auto_id_":"518b31e5-2bc2-4906-a900-226f3c602e50","content":"Not suitable, forward to another service","theme":"default","actions":[{"event":"click","type":"call-function","data":{"name":"setFailReason","params":{"reason":"Not suitable, forward to another service"}},"_auto_id_":"8f5da0cf-77b8-4fa5-a7b0-5cb5c2379040"}],"expressions":{}},{"name":"btnFail3","type":"control","item-type":"button","_auto_id_":"d0d125c1-e818-48d7-8054-579a0da00fa8","content":"Partial completion and forward to another service","theme":"default","actions":[{"event":"click","type":"call-function","data":{"name":"setFailReason","params":{"reason":"Partial completion and forward to another service"}},"_auto_id_":"43af021a-019d-4a10-a297-707fbd44d1bc"}],"expressions":{}},{"name":"btnReasonCancel","type":"control","item-type":"button","_auto_id_":"574fa351-c6fa-4546-b024-0ec4f15a5626","content":"Cancel","theme":"default","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popFailReason"}},"_auto_id_":"643fd5dc-799d-4720-9fd2-cd0d557c7a36"}],"expressions":{},"classes":"red"}],"component":"CTPopupBox","_auto_id_":"d45258a0-8cd3-4e56-9433-e98872f4302e","attributes":{"id":"popFailReason"},"expressions":{}}],"_auto_id_":"d0c6ff0d-4163-4992-9a61-bba053ddb4ec"}]},{"name":"RequestJobs","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","left-icon":"fa-arrow-left","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":"JobList","_auto_id_":"115ecf9d-3d46-4322-bdd0-31dff2fbaeeb"}],"_auto_id_":"5eec381c-ed65-4ec9-9e97-301a6ed8b94f"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"25556ce8-6792-46a2-8e20-07d38c376c0d","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"2972b6e8-9dce-4808-b9b9-dd4db68f41c5","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"sliNoOfJobs","type":"question","item-type":"slider","label":"Number of Jobs:","required":false,"dual":false,"min":5,"max":30,"step":5,"message":"This is a required field","validators":[],"actions":[],"expressions":{},"_auto_id_":"573ac67d-042f-4696-b317-04bbc009b002"}],"_auto_id_":"564881f0-3738-4baf-a5a1-8ce4a7d837f6"},{"name":"nav_footer","type":"navigation","item-type":"button-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnRequestJobs","type":"control","item-type":"button","content":"Request Jobs","theme":"default","expressions":{},"actions":[{"name":"if_1","type":"if","data":{},"operations":[{"type":"value","content":"{{$store.azureAppServices.bulkUpliftAzure.getJobs.length}}","$selected":false},{"type":"operator","content":">","$selected":false},{"type":"value","content":"0","$selected":false}]},{"name":"inline_function_1","event":"click","type":"inline-function","data":{"code":"var popup = document.getElementById('popJobsError');\npopup.togglePopup();"},"_auto_id_":"b33e817b-c344-4b6f-a7bd-d62d1e32f2ef"},{"name":"otherwise_1","type":"otherwise","data":{},"operations":[]},{"event":"click","type":"call-function","data":{"name":"startSpinner"},"_auto_id_":"78f21b07-7bba-4c65-91b2-45902fef0d48"},{"event":"click","type":"call-azure-app-service","data":{"name":"azureEtfService","operation":"getJobs","params":{"neighbourhood":"{{$store.currentPatch}}","numberToGet":"{{$store.pages.RequestJobs.sliNoOfJobs}}","allJobs":"{{$store.getAllJobs}}"}},"_auto_id_":"6c564357-77a9-4c71-8126-638df0368788","actions":[{"event":"fail","type":"call-function","data":{"name":"stopSpinner"},"_auto_id_":"68c05872-7250-4a55-884d-af9553be7675"},{"event":"success","type":"inline-function","data":{"code":"if(cti.store.azureAppServices.azureEtfService.getJobs.length === 0) {\n  cti.stopSpinner();\n  var popup = document.getElementById('popNoJobs');\n  popup.togglePopup();\n}\nelse {\n  cti.utils.callAction('go-to-page', 'JobList');\n}"},"_auto_id_":"9e934994-8315-4326-8a11-749986d17e8c"}]}],"_auto_id_":"b7c44e73-245e-4dc9-afe2-5e57e248ef10"}],"_auto_id_":"ac7568d8-81b2-4bc9-ba40-bee5f0289ac9"},{"name":"staticCompContainer","type":"area","item-type":"static","content":[{"name":"popJobsError","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlJobsError","type":"content","item-type":"html","_auto_id_":"2dd7da43-148f-4898-b465-0311c3927e04","content":"<p>You already have jobs on the device. Please complete these before requesting more.</p>","expressions":{}},{"name":"btnJobsOkay","type":"control","item-type":"button","_auto_id_":"433e20f8-124a-4c5c-a5b1-f4bd873fc8f5","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popJobsError"}},"_auto_id_":"cd4bbdf1-8416-4033-9ef1-3f1809975369"}],"expressions":{},"classes":"green"}],"component":"CTPopupBox","_auto_id_":"9ad989ab-2c2f-435d-b22f-390732974c21","attributes":{"id":"popJobsError"},"expressions":{},"classes":""},{"name":"popNoJobs","type":"component","item-type":"web-component-es2015","template":"<ct-popup-box></ct-popup-box>","content":[{"name":"htmlNoJobs","type":"content","item-type":"html","_auto_id_":"ba2f18a8-78ec-4fed-94f6-d515820ee3aa","content":"<p>No jobs found for the selected neighbourhood. Please select another neighbourhood.</p>","expressions":{}},{"name":"btnNoJobsOkay","type":"control","item-type":"button","_auto_id_":"fba4a51f-c801-4050-8251-1f5750b12fb2","content":"Okay","theme":"default","left-icon":"fa-check","actions":[{"event":"click","type":"call-function","data":{"name":"cancelPopup","params":{"popupId":"popNoJobs"}},"_auto_id_":"62a04fb2-e5db-4554-95b5-3cec0e89bca3"}],"expressions":{},"classes":"green"}],"component":"CTPopupBox","_auto_id_":"5c97a5fa-23fe-4225-80f8-10c219d8a029","attributes":{"id":"popNoJobs"},"expressions":{}},{"name":"ctps_loadpanel_3","type":"component","item-type":"web-component-es2015","template":"<ctps-loadpanel></ctps-loadpanel>","content":[],"component":"ctps_loadpanel","_auto_id_":"36c7459b-20ef-4bcc-a14c-8c9ca0ca035f"}],"expressions":{},"_auto_id_":"1f59908d-31d9-402b-bb73-3b8205b6d395"}]},{"name":"CompletedJobs","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":"JobList","_auto_id_":"9a4d4894-abf5-46c0-af22-6b784265e62f"}],"left-icon":"fa-arrow-left","_auto_id_":"193326ac-ad2a-4578-81d5-720a0cc62c5e"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"a53bde72-12ed-453f-be7a-b4cf3ea090a2","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"9e44fc3a-0aae-4b99-8fb5-c9fbfe2ed88f","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlCompletedJobs","type":"content","item-type":"html","content":"<h2>Completed Jobs</h2>","expressions":{},"_auto_id_":"5402a6ca-d954-4f28-bc13-ec5cef3a3b04"},{"name":"lstCompletedJobs","type":"content","item-type":"list","title":"List","edit":false,"search":false,"row":"<div class=\"jobRow\"> \n  <div class=\"jobCell address full {{$data.$item.responseReceived ? 'completed' : ''}}\">\n    <p class=\"sla\" data-sla=\"{{$data.$item.SLA}}\" data-completion-date=\"{{$data.$item.CompletionDate}}\" data-sla-threshhold=\"{{$data.$item.SLAThreshhold}}\">SLA: {{$data.$item.SLADisplay}} <span class=\"sla-message\"></span></p>\n    <p class=\"name\">{{$data.$item.JobRef}}; {{$data.$item.JobCategory}}</p>\n    <p>Job: <b>{{$data.$item.Status}}</b></p>\n    <p>{{$data.$item.CustomerName}}</p>\n    <p>{{$data.$item.SingleLineAddress}}</p>\n    <p class=\"contact\">{{$data.$item.Phone}}<p>\n  </div>\n</div>","classes":"","expressions":{},"content":[],"actions":[],"model":"$store.completedJobs","_auto_id_":"8a233d58-aa14-43c9-8e0b-efec35109333"}],"_auto_id_":"caf03dc1-b5f9-483c-8d45-f76a18db6937"}]},{"name":"ShiftReview","config":[],"content":[{"name":"title_bar","type":"navigation","item-type":"title-bar","extends":{"type":"area","item-type":"row"},"content":[{"name":"btnBack","type":"control","item-type":"button","content":"","theme":"default","expressions":{},"actions":[{"event":"click","type":"go-to-page","data":"PatchSelect","_auto_id_":"338d7cb0-17df-4a46-8444-97a75e90b069"}],"left-icon":"fa-arrow-left","_auto_id_":"bb96acb1-9a8a-49db-a66a-07e2f7ae4cc8"},{"name":"htmlAppTitle","type":"content","item-type":"html","_auto_id_":"23934baf-9657-41cd-91fc-a22df90485c0","content":"ETF<p class=\"updated\">Last updated: {{'$store.lastSyncDisplay' | store}}</p>","expressions":{}}],"_auto_id_":"f9b382d6-9847-4f7a-a0ab-9ae7a5b33120","expressions":{}},{"name":"scrollable","type":"area","item-type":"scrollable","content":[{"name":"htmlCompletedJobs","type":"content","item-type":"html","content":"<h2>Completed Jobs</h2>","expressions":{},"_auto_id_":"43242fb3-1070-451d-b13c-d54cb1352b4a"},{"name":"lstCompletedJobs","type":"content","item-type":"list","title":"List","edit":false,"search":false,"row":"<div class=\"jobRow\"> \n  <div class=\"jobCell address full {{$data.$item.responseReceived ? 'completed' : ''}}\">\n    <p class=\"sla\" data-sla=\"{{$data.$item.SLA}}\" data-completion-date=\"{{$data.$item.CompletionDate}}\" data-sla-threshhold=\"{{$data.$item.SLAThreshhold}}\">SLA: {{$data.$item.SLADisplay}} <span class=\"sla-message\"></span></p>\n    <p class=\"name\">{{$data.$item.JobRef}}; {{$data.$item.JobCategory}}</p>\n    <p>Job: <b>{{$data.$item.Status}}</b></p>\n    <p>{{$data.$item.CustomerName}}</p>\n    <p>{{$data.$item.SingleLineAddress}}</p>\n    <p class=\"contact\">{{$data.$item.Phone}}<p>\n  </div>\n</div>\n","classes":"","expressions":{},"content":[],"actions":[],"model":"$store.completedJobs","_auto_id_":"6067352e-384c-490e-a43a-1f06389e2a0f"}],"_auto_id_":"e9d2a1f9-0283-4f00-8106-0f9cfed6ef01"}],"start":false}],"config":[{"name":"theme_1","type":"style","item-type":"theme","content":"body {\n    background-color: #f3f3f3\n}\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\np {\n    font-family: Helvetica !important;\n    color: #555\n}\nh2 {\n    font-size: 16px;\n    font-weight: bold;\n    margin-top: 20px;\n    margin-left: 3vw;\n    clear: both\n}\nh2 span.right {\n    float: right;\n    margin-right: 3vw\n}\n.btn-default:hover {\n    background-color: initial;\n    border-color: initial;\n    color: white\n}\nactivity-loader {\n    display: flex;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.4)\n}\nactivity-loader.hidden {\n    display: none\n}\nactivity-loader i {\n    margin: auto\n}\nactivity-loader i:before {\n    font-family: FontAwesome;\n    text-align: center;\n    font-size: 48px;\n    font-style: normal;\n    color: #3E788F;\n    content: \"\\f254\";\n    -webkit-animation: spin 4s linear infinite;\n    animation: spin 4s linear infinite\n}\n@-webkit-keyframes spin {\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg)\n    }\n}\n@keyframes spin {\n    100% {\n        -webkit-transform: rotate(360deg);\n        transform: rotate(360deg)\n    }\n}\nsection.static-item {\n    display:block;\n    flex:none;\n}\nsection[item-type=\"static\"],\nsection[item-type=\"scrollable\"] {\n    border: none !important;\n    background-color: #f3f3f3;\n    -webkit-box-shadow: none;\n    box-shadow: none;\n    padding: 0 !important\n}\nsection[item-type=\"scrollable\"] {\n    overflow-y: auto\n}\nsection[item-type=\"static\"] ul,\nsection[item-type=\"scrollable\"] ul {\n    list-style: none !important;\n    margin: 0 !important;\n    padding: 0 !important\n}\n.md-list ul li {\n    position: initial !important\n}\n.md-list .scrollable {\n    overflow-y: auto !important;\n    margin: 0 !important\n}\n.app-container,\n.page-container {\n    background-color: #f3f3f3\n}\n.content-block {\n    margin-bottom: 0 !important\n}\n#staticSplash {\n    background-color: #3E788F;\n}\n#staticSplash img {\n    margin: 3vh 10vw 3vh;\n    width: 8vw;\n    min-width: 98px;\n    min-height: 160px\n}\n#staticSplash h2 {\n    color: white;\n    line-height: 58px;\n    font-size: 48px;\n    font-weight: bold;\n    margin-left: 10vw;\n    margin-bottom: 5vh\n}\n#staticSplash a#btnStart,\n#staticSplash a#btnStart:hover {\n    border: 1px solid white !important;\n    color: white !important;\n    border-radius: 5px;\n    background-color: #3E788F !important;\n    width: 40vw;\n    padding: 2vh 0\n}\n#staticDescription {\n    height: 20vh\n}\n#staticDescription p {\n    text-align: center;\n    margin: 5vw\n}\n#staticDescription p.version {\n    position: absolute;\n    bottom: 15px;\n    right: 15px;\n    color: #aaa;\n    margin: 0;\n    font-size: 10px\n}\n#staticDescription p.version:before {\n    font-family: FontAwesome;\n    content: \"\\f126\";\n    margin-right: 10px\n}\n#htmlAppTitle {\n\twidth:100%;\n\ttext-align:center;\n\tfont-size:16pt;\n\tmargin-top:4pt;\n}\n#htmlAppTitle  p.updated {\n\twidth:100%;\n\ttext-align:center;\n\tcolor:#BBB;\n\tfont-size:10pt;\n}\n#htmlAppTitle  p.updated:before{\n    font-family: FontAwesome;\n    content: \"\\f0e2\";\n    margin-right: 6px\t\n}\n.sla-warning:after {\n  content: \"\\f071\"; \n  font-family: FontAwesome;\n  font-style: normal;\n  font-weight: normal;\n  text-decoration: inherit;\n  position: absolute;\n  font-size: 48px;\n  color: #ffff99;\n  top: 50%;\n  left: 50%;\n  margin: -18px 0 0 -24px;\n  z-index: -10;\n}\n.last-update {\n\twidth:100%;\n\ttext-align:center;\n\tcolor: #444444;\n}\n.last-update:before {\n    font-family: FontAwesome;\n    content: \"\\f0e2\";\n    margin-right: 10px\t\n}\n\n#titleJobsList,\n#title_bar,\n#nav_footer {\n    background-color: #3E788F;\n    color: white;\n    justify-content: flex-end\n}\n#titleJobsList a#btnMenu,\n#title_bar a#btnMenu,\n#title_bar a#btnBack,\n#nav_footer div a,\n#title_bar a.btn-default:hover {\n    background-color: #3E788F !important;\n    color: white !important;\n    border: none !important\n}\n#title_bar div#btnBack {\n    margin-right: auto\n}\n#nav_footer {\n    justify-content: center\n}\n#nav_footer div {\n    flex-basis: 50%\n}\n#nav_footer div[classes=\"ng-hide\"] {\n    display: none\n}\n#nav_footer div a {\n    font-size: 20px\n}\n.contextMenuBG {\n    position: absolute;\n    width: 100vw;\n    height: 100vh;\n    top: 0;\n    left: 0;\n    background-color: rgba(0, 0, 0, 0.3);\n    z-index: 999\n}\nct-context-menu .contextMenuBG .contextMenu {\n    position: absolute;\n    width: 60vw;\n    height: 100vh;\n    top: 0;\n    right: -60vw;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 1000;\n    -webkit-animation: slide .5s forwards\n}\n@-webkit-keyframes slide {\n    100% {\n        right: 0\n    }\n}\n@keyframes slide {\n    100% {\n        right: 0\n    }\n}\nct-context-menu .contextMenuBG .contextMenu div {\n    margin: 0;\n    border-bottom: 1px solid white\n}\nct-context-menu .contextMenuBG .contextMenu div a,\nct-context-menu .contextMenuBG .contextMenu div a:hover {\n    color: white !important;\n    border: none;\n    background-color: transparent !important;\n    width: 100%;\n    padding: 3vh 0;\n    text-align: left;\n    margin-left: 3vw\n}\nct-context-menu .contextMenuBG .contextMenu div a span span:before {\n    margin-right: 3vw;\n    width: 8vw;\n    display: inline-block;\n    text-align: center\n}\nct-context-menu[popup=\"true\"] .contextMenuBG {\n    background-color: transparent\n}\nct-context-menu[popup=\"true\"] .contextMenu {\n    position: absolute;\n    z-index: 1000;\n    background-color: white;\n    border: 1px solid #d3d3d3;\n    height: initial;\n    -webkit-animation: none\n}\nct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div {\n    border-top: 1px solid #d3d3d3\n}\nct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div:first-child {\n    border-top: none\n}\nct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div a,\nct-context-menu[popup=\"true\"] .contextMenuBG .contextMenu div a:hover {\n    color: black !important;\n    margin-left: 0;\n    text-align: center;\n    padding: 2vh 0\n}\nct-popup-box div.popupBG {\n    display: flex;\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background-color: rgba(0, 0, 0, 0.6);\n    z-index: 999\n}\nct-popup-box div.popupBG div.popupBox {\n    width: 80vw;\n    background-color: white;\n    margin: auto;\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center\n}\nct-popup-box md-content {\n    margin: 2vh auto;\n    text-align: center;\n    padding: 3vh 4vw 0\n}\nct-popup-box .md-button-container {\n    margin: 0 auto !important;\n    width: 72vw\n}\nct-popup-box .md-button-container a,\nct-popup-box .md-button-container a:hover {\n    color: white !important;\n    width: 100%;\n    border: none;\n    padding: 2vh 0;\n    margin-bottom: 2vh\n}\nct-popup-box div[classes=\"green\"] a,\nct-popup-box div[classes=\"green\"] a:hover {\n    background-color: green !important\n}\nct-popup-box div[classes=\"red\"] a,\nct-popup-box div[classes=\"red\"] a:hover {\n    background-color: red !important\n}\nct-popup-box#popFailReason md-content {\n    margin: 0 auto 1vh;\n    padding: 2vh 4vw 0\n}\nct-popup-box#popFailReason .md-button-container a,\nct-popup-box#popFailReason .md-button-container a:hover {\n    color: black !important;\n    border: 1px solid black;\n    padding: 1vh 0;\n    margin-bottom: 1vh;\n    white-space: normal\n}\nct-popup-box#popFailReason div[classes=\"red\"] a,\nct-popup-box#popFailReason div[classes=\"red\"] a:hover {\n    color: white !important;\n    border: 1px solid red\n}\n.box {\n    width: 50vw;\n    height: 15vh;\n    display: flex;\n    flex-direction: column;\n    border: 1px solid #d3d3d3;\n    float: left;\n    background-color: white;\n    text-align: center\n}\n.box:nth-child(3),\n.box:nth-child(4) {\n    border-left: none\n}\n.box h3 {\n    word-wrap: break-word;\n    white-space: pre-line;\n    margin: auto 2vw;\n    font-size: 18px\n}\n.box h3 span {\n    font-size: 62px\n}\n.box.btn {\n    width: 30vw;\n    background-color: #3E788F\n}\n.box.btn h3 {\n    color: white;\n    line-height: 28px\n}\n.jobRow {\n    clear: both;\n    margin: 0\n}\n.jobRow.full {\n    margin: 0 !important\n}\n.jobRow .jobCell {\n    float: left;\n    border-left: 1px solid #d3d3d3;\n    border-right: 1px solid #d3d3d3;\n    border-bottom: 1px solid #d3d3d3;\n    min-height: 25vh;\n    display: flex;\n    flex-direction: column\n}\nul li:first-child span div.jobRow .jobCell {\n    border-top: 1px solid #d3d3d3\n}\n.jobRow.borderTop .jobCell {\n    margin-bottom: 20px;\n    border-top: 1px solid #d3d3d3\n}\n.jobRow .jobCell .sla:before {\n  font-family: FontAwesome;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 30px;\n  margin-right:4px;\n}\n.sla-warn {\n\tbackground-color:yellow;\n\tmargin: -4px 0 -2px 0;\n\twidth:100%;\n\tcolor:#3E788F;\n}\n.sla-fail {\n\tbackground-color:red;\n\tmargin: -4px 0 0 6px;\n\twidth:100%;\n\tcolor:white;\n}\n.sla-warn:before, .sla-fail:before {\n  content: \"\\f071\"; \n}\n.jobRow .jobCell p {\n    margin: auto 3vw;\n    padding: 0\n}\n.jobRow .jobCell.location {\n    width: 15vw;\n    background-color: #d3d3d3;\n    border-bottom: 1px solid white;\n    flex-direction: row\n}\n.jobRow .jobCell.location p,\n.jobRow .jobCell.btn p {\n    margin: auto\n}\n.jobRow .jobCell.location p:before {\n    font-family: FontAwesome;\n    content: \"\\f041\";\n    font-size: 28px\n}\n.jobRow .jobCell.address {\n    width: 85vw;\n    background-color: white\n}\n.jobRow .jobCell.address p.name {\n    font-weight: bold\n}\n.jobRow .jobCell.address p.contact,\n.jobRow .jobCell.address p.contact a {\n    font-weight: bold;\n    color: #3E788F\n}\n.jobRow .jobCell.address.completed {\n    background-color: #dff0d8\n}\n.jobRow .jobCell.btn {\n    width: 15vw;\n    background-color: #3E788F;\n    color: white\n}\n.jobRow .jobCell.btn p:before {\n    font-family: FontAwesome;\n    content: \"\\f054\";\n    color: white;\n    font-size: 28px\n}\n.jobRow .jobCell.full {\n    width: 100vw !important;\n    border-top: 1px solid #d3d3d3\n}\n.jobRow .jobCell:nth-child(3),\n.jobRow .jobCell:nth-child(4) {\n    border-left: none\n}\n.jobRow .jobArrived {\n    background-color: #dff0d8;\n    text-align: center;\n    padding: 2vh 0;\n    color: #3c763d;\n    border-bottom: 1px solid #d6e9c6\n}\n.jobRow.photo .jobCell {\n    height: 175px;\n    background-color: white\n}\n.jobRow.photo .jobCell img,\n.jobRow.photo .jobCell p {\n    margin: auto !important;\n    text-align: center\n}\n.jobRow.photo .jobCell.image,\n.jobRow.photo .jobCell.button {\n    width: 50vw;\n    border-right: none;\n    margin-bottom: 0 !important\n}\n.jobRow.photo .jobCell.button {\n    background-color: #3E788F\n}\n.jobRow.photo .jobCell.button p:before {\n    font-family: FontAwesome;\n    content: \"\\f1f8\";\n    color: white;\n    font-size: 28px\n}\ndiv.jobNotes {\n    padding: 2vh 0;\n    background-color: white;\n    border: 1px solid #d3d3d3;\n    display: flex\n}\ndiv.jobNotes p {\n    margin: auto 3vw\n}\n.itemRow {\n    background-color: white;\n    padding: 1vh 3vw;\n    display: flex;\n    justify-content: flex-start;\n    border-bottom: 1px solid #d3d3d3\n}\nul li:first-child span div.itemRow {\n    border-top: 1px solid #d3d3d3\n}\n.itemRow p {\n    margin: 0\n}\n.itemRow span {\n    margin-left: auto\n}\ndiv#txtCompletionNotes {\n    margin-top: -20px;\n}\ndiv#drpPatchSelect {\n    margin: 3vh;\n}\nmd-question div {\n/*\n    margin: 3vh 1vw 0\n*/\n}\n#sliNoOfJobs {\n\tmargin: 3vh;\n}\n#sliNoOfJobs div {\n    margin: 3vh 3vw 0;\n}\n\ndiv#txtFailMore label {\n    margin-left: 2vw\n}\n/*\ntextarea.form-control {\n    height: 35vh\n}\n*/\n.btn-default:hover {\n    background-color: white !important;\n    border-color: #ccc !important;\n    color: #333 !important\n}\ndiv#btnSelectReason {\n    text-align: left;\n    margin-left: 3vw\n}\n@media only screen and (min-device-width: 320px) and (max-device-width: 568px) {\n    .box h3 {\n        font-size: 12px\n    }\n    .box h3 span {\n        font-size: 42px\n    }\n    .box.btn h3 {\n        line-height: 20px\n    }\n    .jobRow .jobCell {\n        min-height: 25vh;\n    }\n}","_auto_id_":"ac8630c4-4c22-4eb4-96be-aab88d575ae0"},{"name":"openContextMenu","type":"script","item-type":"function","params":[],"content":"var contextMenu = document.getElementsByTagName('ct-context-menu')[0]\ncontextMenu.toggleMenu();","sync":true,"_auto_id_":"f75158cc-d6be-42ad-b61a-49c278f1e038"},{"name":"setCurrentJob","type":"script","item-type":"function","params":[{"name":"rowPos","required":true}],"content":"var currentJob = cti.store.currentJob;\nif (cti.store.pages.JobDetail !== undefined) {\n\tdelete cti.store.pages.JobDetail.txtCompletionNotes;\n}\n\nif(currentJob) {\n  var popup = document.getElementById('popMultiJobErr');\n  popup.togglePopup();\n}\nelse {  \n  cti.store.selectedRow = rowPos;\n  \n  var popup = document.getElementById('popSelectJob');\n  popup.togglePopup();\n}","_auto_id_":"dfda5bbc-fe86-4cf5-9c91-7f262f02cd6d","actions":[]},{"name":"fnFormatDate","type":"script","item-type":"function","_auto_id_":"ea16babe-c383-4a00-89c5-574a3be38177","sync":true,"params":[{"name":"dateObject","description":"The date to be formatted for display"},{"name":"valueIfUndefined","description":"A display value if the supplied date is unset"}],"actions":[],"content":"if (dateObject === undefined || dateObject == null) {\n\treturn valueIfUndefined;\n}\nelse {\n\tvar result = moment(dateObject).format('DD/MM/YY HH:mm');\n    if (result == \"Invalid date\") { return valueIfUndefined; }\n  else { return result; }\n}"},{"name":"cancelPopup","type":"script","item-type":"function","params":[{"name":"popupId","required":true}],"content":"var popup = document.getElementById(popupId);\npopup.togglePopup();","_auto_id_":"1405470f-ad36-4eee-a317-c60293cb0729"},{"name":"addJobEvidence","type":"script","item-type":"function","params":[{"name":"currentJob"}],"content":"if(currentJob.EvidencePhotos !== undefined) {\n  if(currentJob.EvidencePhotos.length > 0) {  \n    for(var i = 0; i < currentJob.EvidencePhotos.length; i++) {\n      var currentEvidence = currentJob.EvidencePhotos[i];\n      \n      var evidence = {\n        JobId: currentJob.Id,\n        Timestamp: moment().format(),\n        Longitude: 0,\n        Latitude: 0\n      }\n      \n      if(currentJob.EvidencePhotos[i].type === 'photo') {\n        var fileName = currentJob.JobRef + '_' + (i + 1);\n        evidence.fileName = fileName;\n        evidence.EvidenceType = 'jobPhoto';\n        evidence.photoRef = currentEvidence.img;\n      }\n      else {\n        var fileName = currentJob.JobRef + '_' + 'Sig';\n        evidence.fileName = fileName;\n        evidence.EvidenceType = 'jobSignature';\n        evidence.sigRef = currentEvidence.img;\n      }\n      \n      //delete currentJob.EvidencePhotos[i].img;\n      \n      var evidenceMsg = {\n        endpoint: 'sendEvidence',\n        payload: evidence \n      }\n      \n      window.commsManager.addToQueue(evidenceMsg);\n    }\n  }\n}","_auto_id_":"8d16f877-c99c-4080-bf3a-39497091f3a8"},{"name":"jobFinished","type":"notification","item-type":"app-notification","options":{"autoDismiss":true,"closeButton":true},"style":"success","actions":[],"_auto_id_":"2bf7f37e-1144-4e4e-bf93-de509ae5ca22"},{"name":"js_asset_1","type":"script","item-type":"js-asset","fileName":"Moment.js","_auto_id_":"f458d4d1-43e8-4b3d-9e78-144c4a5898de"},{"name":"azureEtfService","type":"integration","item-type":"azure-app-services","headers":{},"params":[],"operations":[{"ttlMinutes":0,"name":"getNeighbourhoodDropdown","summary":"Gets the neighbourhood dropdown values","path":"getNeighbourhoodDropdown","method":"GET","params":[{"name":"payload","description":"payload","type":"string","typeConfig":{}}],"$open":true},{"ttlMinutes":0,"name":"getJobs","path":"getJobs","summary":"Gets jobs for selected neighbourhood","method":"GET","params":[{"name":"neighbourhood","description":"Selected neighbourhood","type":"string","typeConfig":{},"required":true},{"name":"numberToGet","description":"Number of jobs to get","type":"string","typeConfig":{},"default":"10","required":true},{"name":"allJobs","description":"Retrieve all jobs (RRT) or not","type":"string","typeConfig":{},"default":"1"}],"$open":true},{"ttlMinutes":0,"name":"updateJob","path":"updateJob","summary":"Update a job","method":"POST","params":[{"name":"payload","description":"payload","type":"string","typeConfig":{}}],"$open":true},{"ttlMinutes":0,"name":"sendEvidence","path":"sendEvidence","summary":"Send evidence","method":"POST","params":[{"name":"payload","description":"payload","type":"string","typeConfig":{}},{"name":"photoRef","description":"photoRef","type":"fileref","typeConfig":{}}],"$open":true},{"ttlMinutes":0,"name":"unlockJobs","summary":"unlockJobs","path":"unlockJobs","method":"POST","params":[{"name":"payload","description":"payload","type":"string","typeConfig":{}}]}],"aasUseBlobStorage":false,"aasUrl":"http://etf.mobileglasgowcity.scot/","aasAuthenticationMethod":"windowsazureactivedirectory","_auto_id_":"727a47be-3db8-4f08-a064-8818c7697964"},{"name":"image_asset_1","type":"style","item-type":"image-asset","fileName":"Glasgow-City-Council-logo-small-3.png","_auto_id_":"6de99cad-111e-4458-836e-7d01912f51ab"},{"name":"cssLoadPanel","type":"style","item-type":"theme","_auto_id_":"37694b8b-135c-4e12-9efa-a04c11659483","content":"/*\n\tAdd these classes into an Infinity style block\n*/\nctps-loadpanel {\n\tdisplay:block;\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(0, 0, 0, 0.4);\n\tz-index:10000;\n    display: none;\n}\n    ctps-loadpanel.active {\n        display: block !important;\n    }\n\nctps-loadpanel .spinner {\n\theight:40px;\n\twidth:40px;\n\ttop:20%;\n\tmargin:auto;\n\tanimation: rotation 1.2s infinite linear;\n\tborder-left:6px solid rgba(0,174,239,.15);\n\tborder-right:6px solid rgba(0,174,239,.15);\n\tborder-bottom:6px solid rgba(0,174,239,.15);\n\tborder-top:6px solid rgba(0,174,239,.8);\n\tborder-radius:100%;\n}\t\nctps-loadpanel .header {\n\theight:25%;\n}\nctps-loadpanel .loading-message {\n\tpadding:10px 20px;\n\ttext-align:center;\n\tfont-size:20px;\n\tcolor:white;\n}\n@keyframes rotation {\n\tfrom {transform: rotate(0deg);}\n\tto {transform: rotate(359deg);}\n}\n"},{"name":"startSpinner","type":"script","item-type":"function","params":[],"content":"\nvar loadpanel = document.getElementsByTagName(\"ctps-loadpanel\");\nif (loadpanel.length > 0) {\n  loadpanel[0].start(\"\");\n}\n\n\tvar loader = document.getElementsByTagName('activity-loader');\n\tif (loader.length > 0) {\n\t\tloader[0].show();\n\t}\n\n","sync":false,"_auto_id_":"c66c0704-f0e1-49ee-a6a8-d6150ea4f9f8"},{"name":"stopSpinner","type":"script","item-type":"function","params":[],"sync":false,"content":"var loadpanel = document.getElementsByTagName(\"ctps-loadpanel\");\nif (loadpanel.length > 0) {\n  loadpanel[0].stop();\n}\n\nvar loader = document.getElementsByTagName('activity-loader');\nif (loader.length > 0) {\n\tloader[0].hide();\n}\n","_auto_id_":"dec69c02-6722-40dc-9847-4e5cbd070314"},{"name":"setFailReason","type":"script","item-type":"function","params":[{"name":"reason","required":true}],"content":"var currentJob = cti.store.currentJob;\ncurrentJob.Reason = reason;\n\ndocument.querySelector('a#btnSelectReason').textContent = reason;\n\nvar popup = document.getElementById('popFailReason');\npopup.togglePopup();","_auto_id_":"5ad4084d-aec4-46b6-8831-97ee6997f752"},{"name":"requestFailed","type":"notification","item-type":"app-notification","_auto_id_":"c6838f8a-6e31-4694-8b9a-c63b80934d81","options":{},"style":"error","title":"Error","text":"Failed to retrieve jobs for the selected neighbourhood"},{"name":"AppleMaps","type":"integration","item-type":"url","_auto_id_":"80fc44c0-f74b-46be-bd7e-ff3c9af2a725","params":{"daddr":""},"target":"_system","url":"http://maps.apple.com"},{"name":"js_asset_4","type":"script","item-type":"js-asset","_auto_id_":"c9860838-85ee-438b-9e15-e1a2a7761f5b","fileName":"startUpScripts.js"},{"name":"jobRefresh","type":"notification","item-type":"app-notification","_auto_id_":"cd82eabc-4029-4d29-b51d-695a1a267521","options":{"autoDismiss":false},"style":"success","title":"Jobs Refreshed","text":"The list of jobs on your device has now been updated, please review the new job(s)."},{"name":"jobRefreshEmpty","type":"notification","item-type":"app-notification","_auto_id_":"9d4ef3ea-9ca0-4575-9a71-6b811d530dac","options":{},"style":"warning","title":"Jobs Refreshed","text":"There are no longer any jobs available in this neighbourhood. Please try another neighbourhood."},{"name":"js_asset_3","type":"script","item-type":"js-asset","_auto_id_":"0f1cc28d-879a-4b82-8585-3ac551334039","fileName":"commsManager.js"}],"components":[{"content":"InVzZSBzdHJpY3QiOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBDVENvbnRleHRNZW51ID0gKGZ1bmN0aW9uIChfSFRNTEVsZW1lbnQpIHsKICAgIF9pbmhlcml0cyhDVENvbnRleHRNZW51LCBfSFRNTEVsZW1lbnQpOwoKICAgIGZ1bmN0aW9uIENUQ29udGV4dE1lbnUoKSB7CiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9DVENvbnRleHRNZW51KTsKCiAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoX0NUQ29udGV4dE1lbnUucHJvdG90eXBlKSwgImNvbnN0cnVjdG9yIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBfY3JlYXRlQ2xhc3MoQ1RDb250ZXh0TWVudSwgW3sKICAgICAgICBrZXk6ICJhdHRhY2hlZENhbGxiYWNrIiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoZWRDYWxsYmFjaygpIHsKICAgICAgICAgICAgdGhpcy5wb3B1cCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdwb3B1cCcpOwogICAgICAgICAgICB0aGlzLm1pbldpZHRoID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ21pbndpZHRoJykgPT09ICdudWxsJyA/IDAgOiBwYXJzZUludCh0aGlzLmdldEF0dHJpYnV0ZSgnbWlud2lkdGgnKSk7CiAgICAgICAgICAgIHRoaXMub3JpZW50YXRpb24gPSB0aGlzLmdldEF0dHJpYnV0ZSgnb3JpZW50YXRpb24nKTsKICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGlyZWN0aW9uJyk7CgogICAgICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSAnY29udGV4dE1lbnVCRyAnICsgdGhpcy5kaXJlY3Rpb247CiAgICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoKICAgICAgICAgICAgdmFyIG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgbWVudS5jbGFzc05hbWUgPSAnY29udGV4dE1lbnUnOwoKICAgICAgICAgICAgd2hpbGUgKHRoaXMuY2hpbGROb2Rlcy5sZW5ndGggIT09IDApIHsKICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQodGhpcy5jaGlsZE5vZGVzWzBdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMud2luZG93U2l6ZUNoYW5nZSk7CgogICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobWVudSk7CiAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKICAgICAgICAgICAgdGhpcy5vcGVuZWQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8vIFRvZ2dsZXMgdGhlIG1lbnUgb3BlbmVkIGFuZCBjbG9zZWQgYmFzZWQgb24gdGhlIHZhbHVlCiAgICAgICAgLy8gb2YgdGhlIHRoaXMub3BlbmVkIHByb3BlcnR5IChpbml0aWFsbHkgc2V0IHRvIGZhbHNlKQogICAgfSwgewogICAgICAgIGtleTogInRvZ2dsZU1lbnUiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b2dnbGVNZW51KCkgewogICAgICAgICAgICB2YXIgY29udGV4dE1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjb250ZXh0TWVudUJHJylbMF07CgogICAgICAgICAgICBpZiAoIXRoaXMub3BlbmVkKSB7CiAgICAgICAgICAgICAgICAvLyBQT1BVUCBMT0dJQwogICAgICAgICAgICAgICAgaWYgKHRoaXMucG9wdXAgPT09ICJ0cnVlIikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Q29udGV4dE1lbnVJbm5lcih0aGlzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLm9wZW5lZCA9IHRydWU7CiAgICAgICAgICAgICAgICBjb250ZXh0TWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2VNZW51LCB0cnVlKTsKICAgICAgICAgICAgICAgIGNvbnRleHRNZW51LnN0eWxlLmRpc3BsYXkgPSAnaW5pdGlhbCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLm9wZW5lZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29udGV4dE1lbnUucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlTWVudSk7CiAgICAgICAgICAgICAgICBjb250ZXh0TWVudS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBUaGUgY2xvc2UgZnVuY3Rpb24gd2UgYmluZCBvdXIgY2xpY2sgZXZlbnQgdG8uIFRoaXMKICAgICAgICAvLyBoYW5kbGVzIGtlZXBpbmcgdGhlICd0aGlzJyBrZXl3b3JkIGluIHNjb3BlCiAgICB9LCB7CiAgICAgICAga2V5OiAiY2xvc2VNZW51IiwKICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2VNZW51KGUpIHsKICAgICAgICAgICAgdmFyIGNvbnRleHRNZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2N0LWNvbnRleHQtbWVudScpWzBdOwogICAgICAgICAgICBjb250ZXh0TWVudS50b2dnbGVNZW51KCk7CiAgICAgICAgfQogICAgfSwgewogICAgICAgIGtleTogInNldENvbnRleHRNZW51SW5uZXIiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRDb250ZXh0TWVudUlubmVyKGNvbnRleHRNZW51KSB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcyAhPT0gQ1RDb250ZXh0TWVudSkgewogICAgICAgICAgICAgICAgdmFyIF90aGlzID0gY29udGV4dE1lbnU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBjb250ZXh0TWVudUlubmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29udGV4dE1lbnUnKVswXTsKICAgICAgICAgICAgdmFyIHBvcyA9IF90aGlzLmdlbmVyYXRlUG9zaXRpb25PblBhZ2UoKTsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnUE9QVVAgUG9zaXRpb25zOiAnLCBwb3MudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGNvbnRleHRNZW51SW5uZXIuc3R5bGUudG9wID0gcG9zLnRvcCArICdweCc7CgogICAgICAgICAgICBpZiAoX3RoaXMub3JpZW50YXRpb24gPT0gJ3JpZ2h0JyAmJiBfdGhpcy5taW5XaWR0aCAhPT0gMCkgewogICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHBvcy5sZWZ0IC0gKF90aGlzLm1pbldpZHRoIC0gcG9zLndpZHRoKTsKICAgICAgICAgICAgICAgIGNvbnRleHRNZW51SW5uZXIuc3R5bGUubGVmdCA9IG9mZnNldCArICdweCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb250ZXh0TWVudUlubmVyLnN0eWxlLmxlZnQgPSBwb3MubGVmdCArICdweCc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChfdGhpcy5taW5XaWR0aCAhPT0gMCAmJiBwb3Mud2lkdGggPCBfdGhpcy5taW5XaWR0aCkgewogICAgICAgICAgICAgICAgY29udGV4dE1lbnVJbm5lci5zdHlsZS53aWR0aCA9IF90aGlzLm1pbldpZHRoICsgJ3B4JzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnRleHRNZW51SW5uZXIuc3R5bGUud2lkdGggPSBwb3Mud2lkdGggKyAncHgnOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwgewogICAgICAgIGtleTogImdlbmVyYXRlUG9zaXRpb25PblBhZ2UiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZVBvc2l0aW9uT25QYWdlKCkgewogICAgICAgICAgICAvLyBURU1QCiAgICAgICAgICAgIHZhciBjYWxsaW5nQnRuSWQgPSBsb2NhbFN0b3JhZ2UuY2FsbGluZ0J0bjsKICAgICAgICAgICAgdmFyIGNhbGxpbmdCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdhIycgKyBjYWxsaW5nQnRuSWQpOwoKICAgICAgICAgICAgdmFyIGNhbGxpbmdCdG5Qb3MgPSBjYWxsaW5nQnRuLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICAgICAgICB2YXIgcGFkVG9wID0gJChjYWxsaW5nQnRuKS5jc3MoJ3BhZGRpbmctdG9wJyk7CiAgICAgICAgICAgIHZhciBwYWRCb3QgPSAkKGNhbGxpbmdCdG4pLmNzcygncGFkZGluZy1ib3R0b20nKTsKICAgICAgICAgICAgdmFyIGJvcmRlcldpZHRoID0gJChjYWxsaW5nQnRuKS5jc3MoJ2JvcmRlci13aWR0aCcpOwoKICAgICAgICAgICAgdmFyIHBhZFRvcCA9IHBhcnNlSW50KHBhZFRvcC5zdWJzdHJpbmcoMCwgcGFkVG9wLmxlbmd0aCAtIDIpKTsKICAgICAgICAgICAgdmFyIHBhZEJvdCA9IHBhcnNlSW50KHBhZEJvdC5zdWJzdHJpbmcoMCwgcGFkQm90Lmxlbmd0aCAtIDIpKTsKICAgICAgICAgICAgdmFyIGJvcmRlcldpZHRoID0gcGFyc2VJbnQoYm9yZGVyV2lkdGguc3Vic3RyaW5nKDAsIGJvcmRlcldpZHRoLmxlbmd0aCAtIDIpKTsKCiAgICAgICAgICAgIHZhciB0b3AgPSBjYWxsaW5nQnRuUG9zLnRvcCArIHBhZFRvcCArIHBhZEJvdCArIGJvcmRlcldpZHRoOwogICAgICAgICAgICB2YXIgbGVmdCA9IGNhbGxpbmdCdG5Qb3MubGVmdDsKICAgICAgICAgICAgdmFyIHJpZ2h0ID0gY2FsbGluZ0J0blBvcy5yaWdodDsKICAgICAgICAgICAgdmFyIHdpZHRoID0gY2FsbGluZ0J0blBvcy53aWR0aDsKCiAgICAgICAgICAgIHZhciByZXMgPSB7CiAgICAgICAgICAgICAgICB0b3A6IHRvcCwKICAgICAgICAgICAgICAgIGxlZnQ6IGxlZnQsCiAgICAgICAgICAgICAgICByaWdodDogcmlnaHQsCiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfQogICAgfSwgewogICAgICAgIGtleTogIndpbmRvd1NpemVDaGFuZ2UiLAogICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aW5kb3dTaXplQ2hhbmdlKCkgewogICAgICAgICAgICB2YXIgY29udGV4dE1lbnUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnY3QtY29udGV4dC1tZW51JylbMF07CgogICAgICAgICAgICBpZiAoY29udGV4dE1lbnUub3BlbmVkKSB7CiAgICAgICAgICAgICAgICBpZiAoY29udGV4dE1lbnUucG9wdXAgPT09ICJ0cnVlIikgewogICAgICAgICAgICAgICAgICAgIGNvbnRleHRNZW51LnNldENvbnRleHRNZW51SW5uZXIoY29udGV4dE1lbnUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfV0pOwoKICAgIHZhciBfQ1RDb250ZXh0TWVudSA9IENUQ29udGV4dE1lbnU7CiAgICBDVENvbnRleHRNZW51ID0gV2ViQ29tcG9uZW50cy5hbm5vdGF0ZSh7CiAgICAgICAgImF0dHJpYnV0ZXMiOiB7CiAgICAgICAgICAgICJwcm9wZXJ0aWVzIjogewogICAgICAgICAgICAgICAgIlBvcHVwIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImJvb2xlYW4iCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIk1pbldpZHRoIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogImludGVnZXIiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgIk9yaWVudGF0aW9uIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAiZGlyZWN0aW9uIjogewogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogInN0cmluZyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgInJlcXVpcmVkIjogWyJQb3B1cCJdCiAgICAgICAgfSwKICAgICAgICAiY29udGFpbmVyIjogdHJ1ZQogICAgfSkoQ1RDb250ZXh0TWVudSkgfHwgQ1RDb250ZXh0TWVudTsKICAgIHJldHVybiBDVENvbnRleHRNZW51Owp9KShIVE1MRWxlbWVudCk7Cgpkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQoJ2N0LWNvbnRleHQtbWVudScsIENUQ29udGV4dE1lbnUpOw==","type":"web-component-es2015","element":"ct-context-menu","usage":"<ct-context-menu></ct-context-menu>","name":"CTContextMenu"},{"content":"InVzZSBzdHJpY3QiOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCJ2YWx1ZSIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gImZ1bmN0aW9uIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCnZhciBDVFBvcHVwQm94ID0gKGZ1bmN0aW9uIChfSFRNTEVsZW1lbnQpIHsKCV9pbmhlcml0cyhDVFBvcHVwQm94LCBfSFRNTEVsZW1lbnQpOwoKCWZ1bmN0aW9uIENUUG9wdXBCb3goKSB7CgkJX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9DVFBvcHVwQm94KTsKCgkJX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoX0NUUG9wdXBCb3gucHJvdG90eXBlKSwgImNvbnN0cnVjdG9yIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCX0KCglfY3JlYXRlQ2xhc3MoQ1RQb3B1cEJveCwgW3sKCQlrZXk6ICJhdHRhY2hlZENhbGxiYWNrIiwKCQl2YWx1ZTogZnVuY3Rpb24gYXR0YWNoZWRDYWxsYmFjaygpIHsKCQkJdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQljb250YWluZXIuY2xhc3NOYW1lID0gJ3BvcHVwQkcnOwoJCQljb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCgkJCXZhciBwb3B1cEJveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoJCQlwb3B1cEJveC5jbGFzc05hbWUgPSAncG9wdXBCb3gnOwoKCQkJd2hpbGUgKHRoaXMuY2hpbGROb2Rlcy5sZW5ndGggIT09IDApIHsKCQkJCXBvcHVwQm94LmFwcGVuZENoaWxkKHRoaXMuY2hpbGROb2Rlc1swXSk7CgkJCX0KCgkJCWNvbnRhaW5lci5hcHBlbmRDaGlsZChwb3B1cEJveCk7CgkJCXRoaXMuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTsKCQkJdGhpcy5vcGVuZWQgPSBmYWxzZTsKCQkJdGhpcy5pZCA9IHRoaXMuZ2V0QXR0cmlidXRlKCJpZCIpOwoJCX0KCgkJLy8gVG9nZ2xlcyB0aGUgbWVudSBvcGVuZWQgYW5kIGNsb3NlZCBiYXNlZCBvbiB0aGUgdmFsdWUKCQkvLyBvZiB0aGUgdGhpcy5vcGVuZWQgcHJvcGVydHkgKGluaXRpYWxseSBzZXQgdG8gZmFsc2UpCgl9LCB7CgkJa2V5OiAidG9nZ2xlUG9wdXAiLAoJCXZhbHVlOiBmdW5jdGlvbiB0b2dnbGVQb3B1cCgpIHsKCQkJdmFyIGNvbnRleHRNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY3QtcG9wdXAtYm94IycgKyB0aGlzLmlkICsgJyA+IC5wb3B1cEJHJyk7CgoJCQlpZiAoIXRoaXMub3BlbmVkKSB7CgkJCQl0aGlzLm9wZW5lZCA9IHRydWU7CgkJCQkvL2NvbnRleHRNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZU1lbnUsIHRydWUpOwoJCQkJY29udGV4dE1lbnUuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKCQkJfSBlbHNlIHsKCQkJCXRoaXMub3BlbmVkID0gZmFsc2U7CgkJCQkvL2NvbnRleHRNZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZU1lbnUpOwoJCQkJY29udGV4dE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCQkJfQoJCX0KCX1dKTsKCgl2YXIgX0NUUG9wdXBCb3ggPSBDVFBvcHVwQm94OwoJQ1RQb3B1cEJveCA9IFdlYkNvbXBvbmVudHMuYW5ub3RhdGUoewoJCSJhdHRyaWJ1dGVzIjogewoJCQkicHJvcGVydGllcyI6IHsKCQkJCSJpZCI6IHsKCQkJCQkidHlwZSI6ICJzdHJpbmciCgkJCQl9CgkJCX0sCgkJCSJyZXF1aXJlZCI6IFsiaWQiXQoJCX0sCgkJImNvbnRhaW5lciI6IHRydWUKCX0pKENUUG9wdXBCb3gpIHx8IENUUG9wdXBCb3g7CglyZXR1cm4gQ1RQb3B1cEJveDsKfSkoSFRNTEVsZW1lbnQpOwoKZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50KCdjdC1wb3B1cC1ib3gnLCBDVFBvcHVwQm94KTs=","type":"web-component-es2015","element":"ct-popup-box","usage":"<ct-popup-box></ct-popup-box>","name":"CTPopupBox"},{"content":"J3VzZSBzdHJpY3QnOwoKdmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTsKCnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTsKCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfQoKZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0KCihmdW5jdGlvbiAoKSB7Cgl2YXIgdGVtcGxhdGUgPSAnPGRpdiBjbGFzcz0iaGVhZGVyIj48L2Rpdj48ZGl2IGNsYXNzPSJzcGlubmVyIj48L2Rpdj48ZGl2IGNsYXNzPSJsb2FkaW5nLW1lc3NhZ2UiPkxvYWRpbmcuLi48L2Rpdj4nOwoKCXZhciBMb2FkUGFuZWwgPSAoZnVuY3Rpb24gKF9IVE1MRWxlbWVudCkgewoJCV9pbmhlcml0cyhMb2FkUGFuZWwsIF9IVE1MRWxlbWVudCk7CgoJCWZ1bmN0aW9uIExvYWRQYW5lbCgpIHsKCQkJX2NsYXNzQ2FsbENoZWNrKHRoaXMsIF9Mb2FkUGFuZWwpOwoKCQkJX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoX0xvYWRQYW5lbC5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJCX0KCgkJX2NyZWF0ZUNsYXNzKExvYWRQYW5lbCwgW3sKCQkJa2V5OiAnYXR0YWNoZWRDYWxsYmFjaycsCgkJCXZhbHVlOiBmdW5jdGlvbiBhdHRhY2hlZENhbGxiYWNrKCkgewoJCQkJdGhpcy5pbm5lckhUTUwgPSB0ZW1wbGF0ZTsKCQkJCXRoaXMuY2xhc3NOYW1lID0gJyc7CgkJCX0KCQl9LCB7CgkJCWtleTogJ3N0YXJ0JywKCgkJCS8vIEludm9rZSAuc3RhcnQgYmVmb3JlIGJlZ2lubmluZyBhIHBvdGVudGlhbGx5IGxvbmcgcnVubmluZywgYmxvY2tpbmcgYWN0aXZpdHkKCQkJdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KG1lc3NhZ2UpIHsKCQkJCXZhciBkaXNwbGF5TWVzc2FnZSA9IG1lc3NhZ2UgPT09IHVuZGVmaW5lZCB8fCBtZXNzYWdlID09IG51bGwgPyAnJyA6IG1lc3NhZ2U7CgkJCQl0aGlzLmNsYXNzTmFtZSA9ICdhY3RpdmUnOwoKCQkJCXRoaXMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgibG9hZGluZy1tZXNzYWdlIilbMF0uaW5uZXJIVE1MID0gZGlzcGxheU1lc3NhZ2U7CgkJCX0KCQl9LCB7CgkJCWtleTogJ3N0b3AnLAoKCQkJLy8gSW52b2tlIC5zdG9wIGF0IHRoZSBlbmQgb2YgdGhlIGFjdGl2aXR5IHNvIG5vcm1hbCBhcHAgaW50ZXJhY3Rpb25zIGNhbiByZXN1bWUKCQkJdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7CgkJCQl0aGlzLmNsYXNzTmFtZSA9ICcnOwoJCQl9CgkJfV0pOwoKCQl2YXIgX0xvYWRQYW5lbCA9IExvYWRQYW5lbDsKCQlMb2FkUGFuZWwgPSBXZWJDb21wb25lbnRzLmFubm90YXRlKHsKCQkJImNvbnRhaW5lciI6IGZhbHNlCgkJfSkoTG9hZFBhbmVsKSB8fCBMb2FkUGFuZWw7CgkJcmV0dXJuIExvYWRQYW5lbDsKCX0pKEhUTUxFbGVtZW50KTsKCglkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQoJ2N0cHMtbG9hZHBhbmVsJywgTG9hZFBhbmVsKTsKfSkoKTs=","type":"web-component-es2015","element":"ctps-loadpanel","usage":"<ctps-loadpanel></ctps-loadpanel>","name":"ctps_loadpanel"}],"metadata":{"version":"0.9.009"},"splashdata":{"img":"Glasgow-City-Council-logo-small-3 1.png","bg":"#3e788f"},"splash":"other","workflows":[],"icondata":"ETF Icon.png","language":{"defaultLocale":"en_GB","initialLanguage":"","useDeviceLocale":true},"actionflows":[{"content":[{"event":"click","type":"inline-function","data":{"sync":true,"code":"cti.variables.jobsRetrieved = false;\n"},"_auto_id_":"bb6dd5a5-cbe1-459c-9ae4-7ef3adf8989a"},{"event":"click","type":"call-function","data":{"name":"startSpinner"},"_auto_id_":"b0215966-fcc9-45b5-8e4d-05c377c494cb"},{"event":"click","type":"call-azure-app-service","data":{"name":"azureEtfService","operation":"getJobs","params":{"neighbourhood":"{{$store.pages.PatchSelect.drpPatchSelect.value}}","numberToGet":"30"}},"_auto_id_":"50e5df36-950a-4a50-9a38-40a82cb09d89","actions":[{"event":"fail","type":"call-function","data":{"name":"stopSpinner"},"_auto_id_":"03c47e57-b1bc-4c5e-b704-87e9fd9bb9eb"},{"event":"fail","type":"show-notification","data":{"options":{"schedule":false,"dynamic":true},"name":"requestFailed"},"_auto_id_":"9de37134-d730-4fc6-94c3-df120ade8365"},{"event":"success","type":"inline-function","data":{"sync":true,"code":"cti.variables.jobsRetrieved = true;\ncti.stopSpinner();\ncti.store.lastSync = new Date();"},"_auto_id_":"cab79e6d-c58a-43d6-9a88-825701ed348f","actions":[]}]}],"name":"afGetJobs"}],"dataflows":[],"schemaVersion":5,"lastSchemaUpgradeDate":"Fri Sep 02 2016 09:15:19 GMT+0100 (GMT Summer Time)","hostContext":0}